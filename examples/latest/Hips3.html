<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd">
<html><head>
<title>Hips3</title>

<link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" rel="stylesheet"/>
<script crossorigin="anonymous" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
<link href="/css/bootstrap.css" rel="stylesheet"/>
<link href="images/favicon.ico" rel="icon" type="image/x-icon"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
</head>
<body>
<nav class="navbar navbar-expand sticky-top navbar-light bg-light">
<a class="navbar-brand" href="/"><img src="/images/logo.svg"/>MultiBUGS</a>
<div class="collapse navbar" id="navbarSupportedContent">
<ul class="navbar-nav mr-auto">
<li class="nav-item">
<a class="nav-link" href="/">Home</a>
</li>
<li class="nav-item">
<a class="nav-link" href="/about">About</a>
</li>
<li class="nav-item">
<a class="nav-link" href="/download">Download</a>
</li>
<li class="nav-item">
<a class="nav-link" href="/documentation/latest/">Documentation</a>
</li>
<li class="nav-item active">
<a class="nav-link" href="/examples/latest/">Examples <span class="sr-only">(current)</span></a>
</li>
</ul>
</div>
</nav><div class="container-fluid"><div class="row main"><div class="col-md-3 col-lg-2 col-xl-3"><div class="sticky-top stickymenu" id="contents">
<button aria-controls="navbarContents" aria-expanded="false" aria-label="Toggle docs navigation" class="btn btn-link d-md-none ml-3 mr-3 mt-3 collapsed mb-toggler" data-target="#navbarContents" data-toggle="collapse" type="button">
<span class="mb-toggler-icon mr-1"></span>
    Contents
  </button>

<h5 class="d-none d-md-block">Examples</h5>
<div class="collapse mb-links" id="navbarContents">
<ul class="list-unstyled">
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#volume1">Volume I</a>
<ul class="collapse" id="volume1">
<li><a href="/examples/latest/Volumei.html">Contents</a></li>
<li><a href="/examples/latest/Rats.html" title="Normal hierarchical model">Rats</a></li>
<li><a href="/examples/latest/Pumps.html" title="Conjugate gamma-Poisson hierarchical model">Pumps</a></li>
<li><a href="/examples/latest/Dogs.html" title="Log linear binary model">Dogs</a></li>
<li><a href="/examples/latest/Seeds.html" title="Random effects logistic regression">Seeds</a></li>
<li><a href="/examples/latest/Surgical.html" title="Institutional ranking">Surgical</a></li>
<li><a href="/examples/latest/Magnesium.html" title="Meta-analysis prior sensitivity">Magnesium</a></li>
<li><a href="/examples/latest/Salm.html" title="Extra-Poisson variation in dose-response study">Salm</a></li>
<li><a href="/examples/latest/Equiv.html" title="Bioequivalence in a cross-over trial">Equiv</a></li>
<li><a href="/examples/latest/Dyes.html" title="Variance components model">Dyes</a></li>
<li><a href="/examples/latest/Stacks.html" title="Robust and ridge regression">Stacks</a></li>
<li><a href="/examples/latest/Epil.html" title="Repeated measures on Poisson counts">Epil</a></li>
<li><a href="/examples/latest/Blockers.html" title="Random effects meta-analysis of clinical trials">Blockers</a></li>
<li><a href="/examples/latest/Oxford.html" title="Smooth fit to log-odds ratios in case control studies">Oxford</a></li>
<li><a href="/examples/latest/Lsat.html" title="Latent variable models for item-response data">LSAT</a></li>
<li><a href="/examples/latest/Bones.html" title="Latent trait model for multiple ordered categorical responses">Bones</a></li>
<li><a href="/examples/latest/Inhalers.html" title="Random effects model for ordinal responses from a cross-over trial">Inhalers</a></li>
<li><a href="/examples/latest/Mice.html" title="Weibull regression in censored survival analysis">Mice</a></li>
<li><a href="/examples/latest/Kidney.html" title="Weibull regression with random effects">Kidney</a></li>
<li><a href="/examples/latest/Leuk.html" title="Survival analysis using Cox regression">Leuk</a></li>
<li><a href="/examples/latest/Leukfr.html" title="Cox regression with frailties">LeukFr</a></li>
</ul>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#volume2">Volume II</a>
<ul class="collapse" id="volume2">
<li><a href="/examples/latest/Volumeii.html">Contents</a></li>
<li><a href="/examples/latest/Dugongs.html" title="A nonconjugate, nonlinear model">Dugongs</a></li>
<li><a href="/examples/latest/Otrees.html" title="A hierarchical, nonlinear model">Orange trees</a></li>
<li><a href="/examples/latest/OtreesMVN.html" title="A hierarchical, nonlinear model">MV Orange trees</a></li>
<li><a href="/examples/latest/Biopsies.html" title="Latent class model">Biopsies</a></li>
<li><a href="/examples/latest/Eyes.html" title="Normal mixture model">Eyes</a></li>
<li><a href="/examples/latest/Hearts.html" title="A mixture model for count data">Hearts</a></li>
<li><a href="/examples/latest/Air.html" title="Covariate measurement error">Air</a></li>
<li><a href="/examples/latest/Cervix.html" title="Case-control study with errors in covariates">Cervix</a></li>
<li><a href="/examples/latest/Jaws.html" title="Repeated measures analysis of variance">Jaw</a></li>
<li><a href="/examples/latest/BiRats.html" title="A bivariate Normal hierarchical model">Birats</a></li>
<li><a href="/examples/latest/Schools.html" title="Multivariate hierarchical model of examination results">Schools</a></li>
<li><a href="/examples/latest/Ice.html" title="Non-parametric smoothing in an age-cohort model">Ice</a></li>
<li><a href="/examples/latest/Beetles.html" title="Logistic, probit and extreme value models">Beetles</a></li>
<li><a href="/examples/latest/Alligators.html" title="Multinomial logistic model">Alligators</a></li>
<li><a href="/examples/latest/Endo.html" title="Conditional inference in case-control studies">Endo</a></li>
<li><a href="/examples/latest/Stagnant.html" title="A change point problem">Stagnant</a></li>
<li><a href="/examples/latest/Asia.html" title="An expert system">Asia</a></li>
<li><a href="/examples/latest/Pigs.html" title="Genetic counseling and pedigree analysis">Pigs</a></li>
<li><a href="/examples/latest/t-df.html" title="Degree of freedom of a t distribution">Simulating data</a></li>
</ul>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#volume3">Volume III</a>
<ul class="collapse show" id="volume3">
<li><a href="/examples/latest/Volumeiii.html">Contents</a></li>
<li><a href="/examples/latest/Camel.html" title="Multivariate normal with structured missing data">Camel</a></li>
<li><a href="/examples/latest/Eyetracking.html" title="Dirichlet process prior">Eye Tracking</a></li>
<li><a href="/examples/latest/Fire.html" title="Data distribution using dloglik">Fire insurance claims</a></li>
<li><a href="/examples/latest/Funshapes.html" title="General constraints">Fun Shapes</a></li>
<li><a href="/examples/latest/Hepatitis.html" title="Random effects model with measurement error">Hepatitis</a></li>
<li><a href="/examples/latest/Hips1.html" title="Deterministic cost-effectiveness model">Hips1</a></li>
<li><a href="/examples/latest/Hips2.html" title="Stochastic cost-effectiveness model">Hips2</a></li>
<li>Hips3</li>
<li><a href="/examples/latest/Hips4.html" title="Cost-effectiveness model">Hips4</a></li>
<li><a href="/examples/latest/Jama.html" title="Radio carbon dating with phase information">Jama</a></li>
<li><a href="/examples/latest/Pigweights.html" title="Smoothed histogram">Pig Weights</a></li>
<li><a href="/examples/latest/Pines.html" title="Bayes factors using pseudo priors">Pines</a></li>
<li><a href="/examples/latest/StVeit.html" title="Radio carbon dating with stratification">St Veit</a></li>
</ul>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#volume4">Volume IV</a>
<ul class="collapse" id="volume4">
<li><a href="/examples/latest/Volumeiv.html">Contents</a></li>
<li><a href="/examples/latest/SeedsDataCloning.html" title="Estimating MLEs">Seeds</a></li>
<li><a href="/examples/latest/Coins.html" title="The ABC">Coins</a></li>
<li><a href="/examples/latest/SmartPhones.html" title="A bootstrap approach">Smart phones</a></li>
<li><a href="/examples/latest/Abbey.html" title="Share prices a stable approach">Abbey</a></li>
<!--<li><a href="/examples/latest/BeetlesMLE.html" title="Differential evolution and MLEs">Beetles</a></li>-->
<li><a href="/examples/latest/BeetlesProbit.html" title="Probit regression and censoring">Beetles</a></li>
<li><a href="/examples/latest/Preeclampsia.html" title="A multistage approach">Preeclampsia</a></li>
<li><a href="/examples/latest/Lotka-Volterra.html" title="A simple ODE model">Lotka-Volterra</a></li>
<li><a href="/examples/latest/FiveCompartment.html" title="A complex ODE model">Five compartment</a></li>
<li><a href="/examples/latest/ChangePoints.html" title="An ODE model with change points">Change points</a></li>
<li><a href="/examples/latest/Pollution.html" title="An autoregressive time series model">Pollution</a></li>
<li><a href="/examples/latest/Methadone.html" title="A large e-health random effects model">Methadone</a></li>
<li><a href="/examples/latest/Functionals.html" title="Integration and algebraic equations">Functionals</a></li>
</ul>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#ecology">Ecology</a>
<ul class="collapse" id="ecology">
<li><a href="/examples/latest/VolumeEco.html">Contents</a></li>
<li><a href="/examples/latest/Gentians.html" title="Imperfect detection in site occppancy">Gentians</a></li>
<li><a href="/examples/latest/Sparrowhawk.html" title="Generalised metapopulation model">Sparrowhawks</a></li>
<li><a href="/examples/latest/Birds.html" title="Estimating species richness">Birds</a></li>
<li><a href="/examples/latest/Lizards.html" title="Mixture model for abundance with imperfect detection">Lizards</a></li>
<li><a href="/examples/latest/Voles.html" title="Estimating size of closed population">Voles</a></li>
<li><a href="/examples/latest/Impala.html" title="Distance sampling">Impala</a></li>
</ul>
</li>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#geobugs">GeoBUGS</a>
<ul class="collapse" id="geobugs">
<li><a href="/examples/latest/spatial/Examples.html">Contents</a></li>
<li><a href="/examples/latest/spatial/Scotland.html" title="Lip cancer in Scotland">Conditional Autoregressive (CAR) models for disease mapping</a></li>
<li><a href="/examples/latest/spatial/LHA.html" title="Lung cancer in a London Health Authority">Convolution priors</a></li>
<li><a href="/examples/latest/spatial/Scotland1.html" title="Lip cancer revisited">Proper CAR model</a></li>
<li><a href="/examples/latest/spatial/Elevation.html" title="Surface elevation">Bayesian kriging and spatial prediction</a></li>
<li><a href="/examples/latest/spatial/Forest.html" title="Distribution of hickory trees in Duke forest">Poisson-gamma spatial moving average (convolution) model</a></li>
<li><a href="/examples/latest/spatial/Huddersfield.html" title="Ecological regression of air pollution and respiratory illness in children">Poisson-gamma spatial moving average (convolution) model</a></li>
<li><a href="/examples/latest/spatial/Shared.html" title="Oral cavity cancer and lung cancer in West Yorkshire (UK)">Shared component for mapping multiple diseases</a></li>
<li><a href="/examples/latest/spatial/Pollution.html">Random walk priors for temporal smoothing of daily air pollution estimates</a></li>
</ul>
</li>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#reliability">ReliaBUGS</a>
<ul class="collapse" id="reliability">
<li><a href="/examples/latest/reliability/Vol.html">Contents</a></li>
<li><a href="/examples/latest/reliability/BS_Ex.html" title="'psi31' data from B&amp;S(1969)">Birnbuam-Saunders model</a></li>
<li><a href="/examples/latest/reliability/BurrX_Ex.html" title="'Ball bearing' data from Lawless(2003)">BurrX model</a></li>
<li><a href="/examples/latest/reliability/BurrXII_Ex.html" title="Simulated example ">BurrXII model</a></li>
<li><a href="/examples/latest/reliability/ExpoWeibull_Ex.html" title="Carbon Fibres data from Nichols and Padgett (2006) ">Two Parameter Exponentiated Weibull Example model</a></li>
<li><a href="/examples/latest/reliability/ExpPower_Ex.html" title="'Simulated data">Exponential Power model</a></li>
<li><a href="/examples/latest/reliability/Ext_exponential_Ex.html" title="'Carbon Fibres data' from Nichols and Padgett (2006)">Marshal-Olkin Extended Exponential (MOEE) model</a></li>
<li><a href="/examples/latest/reliability/Ext_Weibull_Ex.html" title="'Device failure times data' from Meeker and Escobar(1998)">Marshal-Olkin Extended Weibull model</a></li>
<li><a href="/examples/latest/reliability/FlexibleWeibull_Ex.html" title="'Reactor pump failure data' from Bebbinton, Lai, and Zitikis(2007)">Flexible Weibull model</a></li>
<li><a href="/examples/latest/reliability/GenExponential_Cen_Ex.html" title="'Ball bearing' data from Lawless(2003)">Censored Generalized Exponential model</a></li>
<li><a href="/examples/latest/reliability/Gompertz_Ex.html" title="Data from Murthy, Xie, and Jiang(2004)">Gompertz model</a></li>
<li><a href="/examples/latest/reliability/GPWeibull_Ex.html" title="'Carbon Fibres data' from Nichols and Padgett (2006) ">Two Parameter (GP) Exponentiated Weibull Example model</a></li>
<li><a href="/examples/latest/reliability/Gumbel_Ex.html" title="Data from Murthy, Xie, and Jiang(2004)">Gumbel model</a></li>
<li><a href="/examples/latest/reliability/Inv_Weibull_Ex.html" title="Data from Murthy, Xie, and Jiang(2004)">Inverse Weibull model</a></li>
<li><a href="/examples/latest/reliability/InvGaussian_Ex.html" title="'Transceiver data' from Chikara and Folks (9177)">Inverse Gaussian model</a></li>
<li><a href="/examples/latest/reliability/LinearFailure_Ex.html" title="Data from Murthy, Xie, and Jiang(2004)">Linear Failure Rate (LFR) model</a></li>
<li><a href="/examples/latest/reliability/LogisticExponential_Ex.html" title="'Naval logistics' data from Yan and Leemis (2008)">Logistic-Exponential model</a></li>
<li><a href="/examples/latest/reliability/Loglogistic_Ex.html" title="Simulated data">Log-Logistic model</a></li>
<li><a href="/examples/latest/reliability/LogWeibull_Ex.html" title="Data from Murthy, Xie, and Jiang(2004)">Log-Weibull model</a></li>
<li><a href="/examples/latest/reliability/ModifiedWeibull_Ex.html" title="Data from Aarset(1987)">Modified Weibull model</a></li>
<li><a href="/examples/latest/reliability/WeibullShifted_Ex.html" title="Simulated data">Weibull-shifted model</a></li>
</ul>
</li>
</li></li></li></li></ul>
</div>
</div></div><div class="col-12 col-md-9 col-lg-7 col-xl-6">


<p>
<h4>Hips model 3: MC estimates for each strata, allowing for parameter uncertainty in revision hazard, h - gives results for Table 3</h4>Spiegelhalter, D.J. and Best, N.G. “Bayesian approaches to multiple sources of evidence and uncertainty in complex cost-effectiveness modelling”. <u>Statistics in Medicine 22</u>, (2003), 3687-3709.<br/><br/>n = 10000 updates (1 per simulated set of parameter values) are required for this model; monitor C, BL, BQ to get posterior mean and sd for each subgroup for results in top part of Table 3.<br/><br/><strong>For results in bottom part of Table 3:</strong><br/><br/><u>Approach 1: p(s, theta) = p(s | theta) p(theta)</u><br/>m_theta and v_theta are the mean and variance across subgroups for a given value of theta<br/>=&gt; within BUGS code, calculate mean and variance of C[k], BL[k], BQ[k] across subgroups at each iteration, then take Monte Carlo expectation at end of run<br/>=&gt; monitor mean.C, mean.BL, mean.BQ, var.C, var.BL, var.BQ<br/><br/><u>Approach 2: p(s, theta) = p(theta | s) p(s)</u><br/>overall mean, m = weighted mean of posterior means of C[k], BL[k], BQ[k] =&gt; calculate after BUGS run var due to uncertainty, vP2 = weighted mean of posterior variances of C[k], BL[k], BQ[k] =&gt; calculate after BUGS run var due to heterogeneity = vH2 = weighted variance of posterior means of C[k], BL[k], BQ[k] =&gt; calculate after BUGS run<br/><span class="button"><br/></span><strong>Sections of the code that have changed from Model 1 are shown in bold<br/></strong><font color="#000100" face="Arial" size="2">model {<br/><br/></font><font color="#000100" face="Arial" size="2">for(k in 1 : K) { # loop over strata<br/><br/></font># Cost and benefit equations <br/><font color="#000100" face="Arial" size="2">#######################<br/><br/></font># Costs<br/>for(t in 1 : N) {<br/>   ct[k, t] &lt;- inprod(pi[k, t, ], c[]) / pow(1 + delta.c, t - 1)<br/>} <br/><font color="#000100" face="Arial" size="2">C[k] &lt;- C0 + sum(ct[k, ])<br/><br/></font># Benefits - life expectancy<br/>for(t in 1 : N) {<br/>   blt[k, t] &lt;- inprod(pi[k, t, ], bl[]) / pow(1 + delta.b, t - 1)<br/>} <br/><font color="#000100" face="Arial" size="2">BL[k] &lt;- sum(blt[k, ])<br/><br/></font># Benefits - QALYs<br/>for(t in 1 : N) {<br/>   bqt[k, t] &lt;- inprod(pi[k, t, ], bq[]) / pow(1 + delta.b, t - 1)<br/>} <br/><font color="#000100" face="Arial" size="2">BQ[k] &lt;- sum(bqt[k, ])<br/><br/><br/></font># Markov model probabilities:<br/><font color="#000100" face="Arial" size="2">#######################<br/><br/></font># Transition matrix<br/>for(t in 2 : N) {<br/>Lambda[k, t, 1, 1] &lt;- 1 - gamma[k, t] - lambda[k, t]<br/>Lambda[k, t, 1, 2] &lt;- gamma[k, t] * lambda.op<br/>Lambda[k, t, 1, 3] &lt;- gamma[k, t] *(1 - lambda.op)<br/>Lambda[k, t, 1, 4] &lt;- 0<br/><font color="#000100" face="Arial" size="2">Lambda[k, t, 1, 5] &lt;- lambda[k, t] <br/><br/></font>Lambda[k, t, 2, 1] &lt;- 0<br/>Lambda[k, t, 2, 2] &lt;- 0 <br/>Lambda[k, t, 2, 3] &lt;- 0 <br/>Lambda[k, t, 2, 4] &lt;- 0 <br/><font color="#000100" face="Arial" size="2">Lambda[k, t, 2, 5] &lt;- 1 <br/><br/></font>Lambda[k, t, 3, 1] &lt;- 0<br/>Lambda[k, t, 3, 2] &lt;- 0 <br/>Lambda[k,t,3,3] &lt;- 0<br/>Lambda[k, t, 3, 4] &lt;- 1 - lambda[k, t]<br/><font color="#000100" face="Arial" size="2">Lambda[k, t, 3, 5] &lt;- lambda[k, t]<br/><br/></font>Lambda[k, t, 4, 1] &lt;- 0<br/>Lambda[k, t, 4, 2] &lt;- rho * lambda.op<br/>Lambda[k,t,4,3] &lt;- rho * (1 - lambda.op)<br/>Lambda[k, t, 4, 4] &lt;- 1 - rho - lambda[k, t]<br/><font color="#000100" face="Arial" size="2">Lambda[k, t, 4, 5] &lt;- lambda[k, t]<br/><br/></font>Lambda[k, t, 5, 1] &lt;- 0<br/>Lambda[k, t, 5, 2] &lt;- 0 <br/>Lambda[k, t, 5, 3] &lt;- 0<br/>Lambda[k, t, 5, 4] &lt;- 0<br/><font color="#000100" face="Arial" size="2">Lambda[k, t, 5,5 ] &lt;- 1<br/><br/></font>gamma[k, t] &lt;- h[k] * (t - 1)<br/><font color="#000100" face="Arial" size="2">}<br/><br/></font># Marginal probability of being in each state at time 1<br/><font color="#000100" face="Arial" size="2">pi[k,1,1] &lt;- 1 - lambda.op pi[k,1, 2] &lt;- 0 pi[k,1, 3] &lt;- 0 ; <br/>         pi[k,1, 4] &lt;- 0 pi[k,1, 5] &lt;- lambda.op<br/><br/></font># Marginal probability of being in each state at time t &gt; 1<br/>for(t in 2 : N) {<br/>for(s in 1 : S) {<br/>   pi[k, t, s] &lt;- inprod(pi[k, t - 1, ], Lambda[k, t, , s])<br/>}<br/>}<br/><font color="#000100" face="Arial" size="2">}<br/><br/></font><font color="#000000" face="Arial" size="2"><strong># age-sex specific revision hazard<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>for(k in 1 : K) { <br/></strong></font><font color="#000000" face="Arial" size="2"><strong>logh[k] ~ dnorm(logh0[k], tau)<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>h[k] &lt;- exp(logh[k]) <br/></strong></font><font color="#000000" face="Arial" size="2"><strong>}<br/><br/></strong></font><font color="#000000" face="Arial" size="2"><strong># Calculate mean and variance across strata at each iteration <br/></strong></font><font color="#000000" face="Arial" size="2"><strong># (Gives overall mean and variance using approach 1)<br/><br/></strong></font><font color="#000000" face="Arial" size="2"><strong>mean.C &lt;- inprod(p.strata[], C[])<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>mean.BL &lt;- inprod(p.strata[], BL[])<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>mean.BQ &lt;- inprod(p.strata[], BQ[])<br/><br/></strong></font><font color="#000000" face="Arial" size="2"><strong>for(k in 1:12) {<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>C.dev[k] &lt;- pow(C[k]-mean.C , 2)<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>BL.dev[k] &lt;- pow(BL[k]-mean.BL , 2)<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>BQ.dev[k] &lt;- pow(BQ[k]-mean.BQ , 2)<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>   }<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>var.C &lt;- inprod(p.strata[], C.dev[])<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>var.BL &lt;- inprod(p.strata[], BL.dev[])<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>var.BQ &lt;- inprod(p.strata[], BQ.dev[])</strong></font><font color="#000100" face="Arial" size="2">}<br/><br/><br/></font><a href="/examples/latest/Hipsdata3.html"></a><div><h5>Data</h5><details><code>
list(N = 60, # Number of cycles<br/>K = 12, # Number of age-sex strata<br/>S = 5, # Number of states in Markov model<br/>rho = 0.04, # re-revision rate<br/>lambda.op = 0.01, # post-operative mortality rate<br/># age-sex specific revision hazard:<br/>logh0 = c(-6.119, -6.119, -6.119, -6.438, -6.438, -6.438, -6.377, -6.377, -6.377, -6.725, -6.725, -6.725), <br/>tau = 25, # inverse variance reflecting uncertainty about log revision hazard (= 1 / 0.2^2)<br/>C0 = 4052, # set-up costs of primary operation<br/>c = c(0, 5290, 5290, 0, 0), # additional costs associated with each state (zero except for revision states 2 and 3) <br/>bl = c(1,0,1,1,0), # life-expectancy benefits associated with each state (one except for death states 2 and 5)<br/>bq = c(0.938, -0.622, -0.3387, 0.938, 0), # QALYs associated with each state<br/>delta.c = 0.06, # cost discount<br/>delta.b = 0.06, # health discount<br/>p.strata = c(0.02, 0.03, 0.07, 0.13, 0.10, 0.00, 0.02, 0.04, 0.10, 0.22, 0.26, 0.01), # age-sex distribution <br/>lambda = structure(.Data = c(0.0017, 0.0017, 0.0017, 0.0017, 0.0017, 0.0044, 0.0044, <br/>   0.0044, 0.0044, 0.0044, 0.0044, 0.0044, 0.0044, 0.0044, 0.0044, 0.0138,<br/>   0.0138, 0.0138, 0.0138, 0.0138, 0.0138, 0.0138, 0.0138, 0.0138, 0.0138,<br/>   0.0379, 0.0379, 0.0379, 0.0379, 0.0379, 0.0379, 0.0379, 0.0379, 0.0379,<br/>   0.0379, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912,<br/>   0.0912, 0.0912, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.0044,<br/>   0.0044, 0.0044, 0.0044, 0.0044, 0.0138, 0.0138, 0.0138, 0.0138, 0.0138,<br/>   0.0138, 0.0138, 0.0138, 0.0138, 0.0138, 0.0379, 0.0379, 0.0379, 0.0379,<br/>   0.0379, 0.0379, 0.0379, 0.0379, 0.0379, 0.0379, 0.0912, 0.0912, 0.0912,<br/>   0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.0138, 0.0138, 0.0138, 0.0138,<br/>   0.0138, 0.0379, 0.0379, 0.0379, 0.0379, 0.0379, 0.0379, 0.0379, 0.0379,<br/>   0.0379, 0.0379, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912,<br/>   0.0912, 0.0912, 0.0912, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.0379, 0.0379, 0.0379, 0.0379, 0.0379, 0.0912, 0.0912,<br/>   0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.0912,<br/>   0.0912, 0.0912, 0.0912, 0.0912, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.0011, 0.0011, 0.0011, 0.0011, 0.0011, 0.0028, 0.0028,<br/>   0.0028, 0.0028, 0.0028, 0.0028, 0.0028, 0.0028, 0.0028, 0.0028, 0.0081,<br/>   0.0081, 0.0081, 0.0081, 0.0081, 0.0081, 0.0081, 0.0081, 0.0081, 0.0081,<br/>   0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, <br/>   0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.0578,<br/>   0.0578, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.0028, 0.0028,<br/>   0.0028, 0.0028, 0.0028, 0.0081, 0.0081, 0.0081, 0.0081, 0.0081, 0.0081,<br/>   0.0081, 0.0081, 0.0081, 0.0081, 0.022, 0.022, 0.022, 0.022, 0.022, <br/>   0.022, 0.022, 0.022, 0.022, 0.022, 0.0578, 0.0578, 0.0578, 0.0578, <br/>   0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.0081, 0.0081, 0.0081, 0.0081, 0.0081,<br/>   0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, <br/>   0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.0578,<br/>   0.0578, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.022, 0.022, 0.022, 0.022, 0.022, 0.0578, 0.0578, 0.0578, 0.0578, <br/>   0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.0578, 0.0578, 0.0578,<br/>   0.0578, 0.0578, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503<br/>   ), .Dim=c(12,60))<br/>)
</code></details></div><br/><br/><font color="#0000FF" face="Arial" size="5">Results</font>Note: results for the bottom panel of Table 3 (approach 1) for costs are given by<br/>m = posterior mean of mean.C = 4609<br/>vP1 = posterior variance of mean.C = 31.82 * 31.82<br/>vH1 = posterior mean of var.C = 174400<br/><strong>   'Model' to calculate overall mean (m), var due to uncertainty (vP2) and var due to heterogeneity (vH2)    using approach 2</strong><br/>   <br/>   No updates needed - just compile model, load data, and gen inits, then use node tool from info menu to obtain values of    mC, mBL, mBQ, vP2.C, vP2.BL, vP2.BQ, vH2.C, vH2.BL, vH2.BQ, TC, TBL, TBQ, pcC, pcBL, pcBQ.<br/><font color="#000100" face="Arial" size="2">   model { <br/>   <br/>   # overall mean outcome (m)<br/>mC &lt;- inprod(p.strata[], C[])<br/>mBL &lt;- inprod(p.strata[], BL[])<br/>mBQ &lt;- inprod(p.strata[], BQ[])<br/><br/># variance due to uncertainty, vP<br/>for(k in 1:12) {<br/>VC[k] &lt;- sdC[k]*sdC[k]<br/>VBL[k] &lt;- sdBL[k]*sdBL[k]<br/>VBQ[k] &lt;- sdBQ[k]*sdBQ[k]<br/>}<br/>vP2.C &lt;- inprod(p.strata[], VC[])<br/>vP2.BL &lt;- inprod(p.strata[], VBL[])<br/>vP2.BQ &lt;- inprod(p.strata[], VBQ[])<br/><br/># variance due to heterogeneity, vH<br/>for(k in 1:12) { devC[k] &lt;- pow(C[k] - mC, 2) }<br/>vH2.C &lt;- inprod(p.strata[], devC[])<br/>for(k in 1:12) { devBL[k] &lt;- pow(BL[k] - mBL, 2) }<br/>vH2.BL &lt;- inprod(p.strata[], devBL[])<br/>for(k in 1:12) { devBQ[k] &lt;- pow(BQ[k] - mBQ, 2) }<br/>vH2.BQ &lt;- inprod(p.strata[], devBQ[])<br/><br/># Percent of total variance due to heterogeneity<br/>TC &lt;- vP2.C + vH2.C<br/>pcC &lt;- vH2.C/TC<br/>TBL &lt;- vP2.BL + vH2.BL<br/>pcBL &lt;- vH2.BL/TBL<br/>TBQ &lt;- vP2.BQ + vH2.BQ<br/>pcBQ &lt;- vH2.BQ/TBQ<br/><br/>}<br/></font>Posterior means and posterior sd of C, BL and BQ from running model 3:<a href="/examples/latest/Hipsdata32.html"></a><div><h5>Data</h5><code>
<br/>list(<br/># posterior means<br/>BL=c(14.48, 12.7, 10.34, 7.737, 5.405, 4.101, 15.13, 13.69, 11.65, 9.1, 6.46, 4.988),    <br/>BQ = c(13.17, 11.59, 9.469, 7.157, 5.019, 3.812, 13.82, 12.53, 10.69, 8.43, 6.004, 4.64),<br/>C = c(5787.0, 5425.0, 4997.0, 4472.0, 4266.0, 4196.0, 5636.0, 5359.0, 5010.0, 4493.0, 4285.0, 4215.0),<br/>#posterior sd's<br/>sdBL = c(0.005166, 0.003677, 0.002138, 0.0007832, 0.0003237,    0.0002136,    0.005161, 0.003836,   0.002427,   0.0009526, 0.0004226, 0.0002918),<br/>sdBQ = c(0.06027,    0.05198, 0.03841,    0.01873,    0.009921,    0.006748,    0.05718,    0.05006, 0.03914, 0.01989, 0.01083, 0.007627), <br/>sdC = c(230.8, 202.1, 151.6, 74.94,    40.06,    27.27, 218.0, 193.5, 153.5, 79.14, 43.46, 30.63), <br/>p.strata = c(0.02, 0.03, 0.07, 0.13, 0.10, 0.00, 0.02, 0.04, 0.10, 0.22, 0.26, 0.01),<br/># strata weights (prob of hip replacement by age and sex) <br/>p.strata = c(0.02, 0.03, 0.07, 0.13, 0.10, 0.00, 0.02, 0.04, 0.10, 0.22, 0.26, 0.01)<br/>)<br/>
</code></div><br/>Results<br/>mC 4609.03<br/>mBL 8.687390000000001<br/>mBQ 8.01488<br/>vP2.C 11472.793425<br/>vP2.BL 3.3068250474E-6<br/>vP2.BQ 7.493649773900001E-4<br/>vH2.C 163953.4291<br/>vH2.BL 6.713258897899999<br/>vH2.BQ 5.464389485600001<br/>TC 175426.222525<br/>TBL 6.713262204725046<br/>TBQ 5.465138850577391<br/>pcC 0.9346004647431485<br/>pcBL 0.999999507419054<br/>pcBQ 0.9998628827193821

</p>


</div><div class="d-none d-lg-block col-lg-3 col-xl-3" id="onthispage"><div class="sticky-top stickymenu"><h5>On this page</h5></div></div></div></div></body></html>