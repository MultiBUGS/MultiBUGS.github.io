<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd">
<html><head>
<title>Lotka-Volterra</title>

<link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" rel="stylesheet"/>
<script crossorigin="anonymous" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
<link href="/css/bootstrap.css" rel="stylesheet"/>
<link href="images/favicon.ico" rel="icon" type="image/x-icon"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
</head>
<body>
<nav class="navbar navbar-expand sticky-top navbar-light bg-light">
<a class="navbar-brand" href="/"><img src="/images/logo.svg"/>MultiBUGS</a>
<div class="collapse navbar" id="navbarSupportedContent">
<ul class="navbar-nav mr-auto">
<li class="nav-item">
<a class="nav-link" href="/">Home</a>
</li>
<li class="nav-item">
<a class="nav-link" href="/about">About</a>
</li>
<li class="nav-item">
<a class="nav-link" href="/download">Download</a>
</li>
<li class="nav-item">
<a class="nav-link" href="/documentation/latest/">Documentation</a>
</li>
<li class="nav-item active">
<a class="nav-link" href="/examples/latest/">Examples <span class="sr-only">(current)</span></a>
</li>
</ul>
</div>
</nav><div class="container-fluid"><div class="row main"><div class="col-md-3 col-lg-2 col-xl-3"><div class="sticky-top stickymenu" id="contents">
<button aria-controls="navbarContents" aria-expanded="false" aria-label="Toggle docs navigation" class="btn btn-link d-md-none ml-3 mr-3 mt-3 collapsed mb-toggler" data-target="#navbarContents" data-toggle="collapse" type="button">
<span class="mb-toggler-icon mr-1"></span>
    Contents
  </button>

<h5 class="d-none d-md-block">Examples</h5>
<div class="collapse mb-links" id="navbarContents">
<ul class="list-unstyled">
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#volume1">Volume I</a>
<ul class="collapse" id="volume1">
<li><a href="/examples/latest/Volumei.html">Contents</a></li>
<li><a href="/examples/latest/Rats.html" title="Normal hierarchical model">Rats</a></li>
<li><a href="/examples/latest/Pumps.html" title="Conjugate gamma-Poisson hierarchical model">Pumps</a></li>
<li><a href="/examples/latest/Dogs.html" title="Log linear binary model">Dogs</a></li>
<li><a href="/examples/latest/Seeds.html" title="Random effects logistic regression">Seeds</a></li>
<li><a href="/examples/latest/Surgical.html" title="Institutional ranking">Surgical</a></li>
<li><a href="/examples/latest/Magnesium.html" title="Meta-analysis prior sensitivity">Magnesium</a></li>
<li><a href="/examples/latest/Salm.html" title="Extra-Poisson variation in dose-response study">Salm</a></li>
<li><a href="/examples/latest/Equiv.html" title="Bioequivalence in a cross-over trial">Equiv</a></li>
<li><a href="/examples/latest/Dyes.html" title="Variance components model">Dyes</a></li>
<li><a href="/examples/latest/Stacks.html" title="Robust and ridge regression">Stacks</a></li>
<li><a href="/examples/latest/Epil.html" title="Repeated measures on Poisson counts">Epil</a></li>
<li><a href="/examples/latest/Blockers.html" title="Random effects meta-analysis of clinical trials">Blockers</a></li>
<li><a href="/examples/latest/Oxford.html" title="Smooth fit to log-odds ratios in case control studies">Oxford</a></li>
<li><a href="/examples/latest/Lsat.html" title="Latent variable models for item-response data">LSAT</a></li>
<li><a href="/examples/latest/Bones.html" title="Latent trait model for multiple ordered categorical responses">Bones</a></li>
<li><a href="/examples/latest/Inhalers.html" title="Random effects model for ordinal responses from a cross-over trial">Inhalers</a></li>
<li><a href="/examples/latest/Mice.html" title="Weibull regression in censored survival analysis">Mice</a></li>
<li><a href="/examples/latest/Kidney.html" title="Weibull regression with random effects">Kidney</a></li>
<li><a href="/examples/latest/Leuk.html" title="Survival analysis using Cox regression">Leuk</a></li>
<li><a href="/examples/latest/Leukfr.html" title="Cox regression with frailties">LeukFr</a></li>
</ul>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#volume2">Volume II</a>
<ul class="collapse" id="volume2">
<li><a href="/examples/latest/Volumeii.html">Contents</a></li>
<li><a href="/examples/latest/Dugongs.html" title="A nonconjugate, nonlinear model">Dugongs</a></li>
<li><a href="/examples/latest/Otrees.html" title="A hierarchical, nonlinear model">Orange trees</a></li>
<li><a href="/examples/latest/OtreesMVN.html" title="A hierarchical, nonlinear model">MV Orange trees</a></li>
<li><a href="/examples/latest/Biopsies.html" title="Latent class model">Biopsies</a></li>
<li><a href="/examples/latest/Eyes.html" title="Normal mixture model">Eyes</a></li>
<li><a href="/examples/latest/Hearts.html" title="A mixture model for count data">Hearts</a></li>
<li><a href="/examples/latest/Air.html" title="Covariate measurement error">Air</a></li>
<li><a href="/examples/latest/Cervix.html" title="Case-control study with errors in covariates">Cervix</a></li>
<li><a href="/examples/latest/Jaws.html" title="Repeated measures analysis of variance">Jaw</a></li>
<li><a href="/examples/latest/BiRats.html" title="A bivariate Normal hierarchical model">Birats</a></li>
<li><a href="/examples/latest/Schools.html" title="Multivariate hierarchical model of examination results">Schools</a></li>
<li><a href="/examples/latest/Ice.html" title="Non-parametric smoothing in an age-cohort model">Ice</a></li>
<li><a href="/examples/latest/Beetles.html" title="Logistic, probit and extreme value models">Beetles</a></li>
<li><a href="/examples/latest/Alligators.html" title="Multinomial logistic model">Alligators</a></li>
<li><a href="/examples/latest/Endo.html" title="Conditional inference in case-control studies">Endo</a></li>
<li><a href="/examples/latest/Stagnant.html" title="A change point problem">Stagnant</a></li>
<li><a href="/examples/latest/Asia.html" title="An expert system">Asia</a></li>
<li><a href="/examples/latest/Pigs.html" title="Genetic counseling and pedigree analysis">Pigs</a></li>
<li><a href="/examples/latest/t-df.html" title="Degree of freedom of a t distribution">Simulating data</a></li>
</ul>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#volume3">Volume III</a>
<ul class="collapse" id="volume3">
<li><a href="/examples/latest/Volumeiii.html">Contents</a></li>
<li><a href="/examples/latest/Camel.html" title="Multivariate normal with structured missing data">Camel</a></li>
<li><a href="/examples/latest/Eyetracking.html" title="Dirichlet process prior">Eye Tracking</a></li>
<li><a href="/examples/latest/Fire.html" title="Data distribution using dloglik">Fire insurance claims</a></li>
<li><a href="/examples/latest/Funshapes.html" title="General constraints">Fun Shapes</a></li>
<li><a href="/examples/latest/Hepatitis.html" title="Random effects model with measurement error">Hepatitis</a></li>
<li><a href="/examples/latest/Hips1.html" title="Deterministic cost-effectiveness model">Hips1</a></li>
<li><a href="/examples/latest/Hips2.html" title="Stochastic cost-effectiveness model">Hips2</a></li>
<li><a href="/examples/latest/Hips3.html" title="Cost-effectiveness model">Hips3</a></li>
<li><a href="/examples/latest/Hips4.html" title="Cost-effectiveness model">Hips4</a></li>
<li><a href="/examples/latest/Jama.html" title="Radio carbon dating with phase information">Jama</a></li>
<li><a href="/examples/latest/Pigweights.html" title="Smoothed histogram">Pig Weights</a></li>
<li><a href="/examples/latest/Pines.html" title="Bayes factors using pseudo priors">Pines</a></li>
<li><a href="/examples/latest/StVeit.html" title="Radio carbon dating with stratification">St Veit</a></li>
</ul>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#volume4">Volume IV</a>
<ul class="collapse show" id="volume4">
<li><a href="/examples/latest/Volumeiv.html">Contents</a></li>
<li><a href="/examples/latest/SeedsDataCloning.html" title="Estimating MLEs">Seeds</a></li>
<li><a href="/examples/latest/Coins.html" title="The ABC">Coins</a></li>
<li><a href="/examples/latest/SmartPhones.html" title="A bootstrap approach">Smart phones</a></li>
<li><a href="/examples/latest/Abbey.html" title="Share prices a stable approach">Abbey</a></li>
<!--<li><a href="/examples/latest/BeetlesMLE.html" title="Differential evolution and MLEs">Beetles</a></li>-->
<li><a href="/examples/latest/BeetlesProbit.html" title="Probit regression and censoring">Beetles</a></li>
<li><a href="/examples/latest/Preeclampsia.html" title="A multistage approach">Preeclampsia</a></li>
<li>Lotka-Volterra</li>
<li><a href="/examples/latest/FiveCompartment.html" title="A complex ODE model">Five compartment</a></li>
<li><a href="/examples/latest/ChangePoints.html" title="An ODE model with change points">Change points</a></li>
<li><a href="/examples/latest/Pollution.html" title="An autoregressive time series model">Pollution</a></li>
<li><a href="/examples/latest/Methadone.html" title="A large e-health random effects model">Methadone</a></li>
<li><a href="/examples/latest/Functionals.html" title="Integration and algebraic equations">Functionals</a></li>
</ul>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#ecology">Ecology</a>
<ul class="collapse" id="ecology">
<li><a href="/examples/latest/VolumeEco.html">Contents</a></li>
<li><a href="/examples/latest/Gentians.html" title="Imperfect detection in site occppancy">Gentians</a></li>
<li><a href="/examples/latest/Sparrowhawk.html" title="Generalised metapopulation model">Sparrowhawks</a></li>
<li><a href="/examples/latest/Birds.html" title="Estimating species richness">Birds</a></li>
<li><a href="/examples/latest/Lizards.html" title="Mixture model for abundance with imperfect detection">Lizards</a></li>
<li><a href="/examples/latest/Voles.html" title="Estimating size of closed population">Voles</a></li>
<li><a href="/examples/latest/Impala.html" title="Distance sampling">Impala</a></li>
</ul>
</li>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#geobugs">GeoBUGS</a>
<ul class="collapse" id="geobugs">
<li><a href="/examples/latest/spatial/Examples.html">Contents</a></li>
<li><a href="/examples/latest/spatial/Scotland.html" title="Lip cancer in Scotland">Conditional Autoregressive (CAR) models for disease mapping</a></li>
<li><a href="/examples/latest/spatial/LHA.html" title="Lung cancer in a London Health Authority">Convolution priors</a></li>
<li><a href="/examples/latest/spatial/Scotland1.html" title="Lip cancer revisited">Proper CAR model</a></li>
<li><a href="/examples/latest/spatial/Elevation.html" title="Surface elevation">Bayesian kriging and spatial prediction</a></li>
<li><a href="/examples/latest/spatial/Forest.html" title="Distribution of hickory trees in Duke forest">Poisson-gamma spatial moving average (convolution) model</a></li>
<li><a href="/examples/latest/spatial/Huddersfield.html" title="Ecological regression of air pollution and respiratory illness in children">Poisson-gamma spatial moving average (convolution) model</a></li>
<li><a href="/examples/latest/spatial/Shared.html" title="Oral cavity cancer and lung cancer in West Yorkshire (UK)">Shared component for mapping multiple diseases</a></li>
<li><a href="/examples/latest/spatial/Pollution.html">Random walk priors for temporal smoothing of daily air pollution estimates</a></li>
</ul>
</li>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#reliability">ReliaBUGS</a>
<ul class="collapse" id="reliability">
<li><a href="/examples/latest/reliability/Vol.html">Contents</a></li>
<li><a href="/examples/latest/reliability/BS_Ex.html" title="'psi31' data from B&amp;S(1969)">Birnbuam-Saunders model</a></li>
<li><a href="/examples/latest/reliability/BurrX_Ex.html" title="'Ball bearing' data from Lawless(2003)">BurrX model</a></li>
<li><a href="/examples/latest/reliability/BurrXII_Ex.html" title="Simulated example ">BurrXII model</a></li>
<li><a href="/examples/latest/reliability/ExpoWeibull_Ex.html" title="Carbon Fibres data from Nichols and Padgett (2006) ">Two Parameter Exponentiated Weibull Example model</a></li>
<li><a href="/examples/latest/reliability/ExpPower_Ex.html" title="'Simulated data">Exponential Power model</a></li>
<li><a href="/examples/latest/reliability/Ext_exponential_Ex.html" title="'Carbon Fibres data' from Nichols and Padgett (2006)">Marshal-Olkin Extended Exponential (MOEE) model</a></li>
<li><a href="/examples/latest/reliability/Ext_Weibull_Ex.html" title="'Device failure times data' from Meeker and Escobar(1998)">Marshal-Olkin Extended Weibull model</a></li>
<li><a href="/examples/latest/reliability/FlexibleWeibull_Ex.html" title="'Reactor pump failure data' from Bebbinton, Lai, and Zitikis(2007)">Flexible Weibull model</a></li>
<li><a href="/examples/latest/reliability/GenExponential_Cen_Ex.html" title="'Ball bearing' data from Lawless(2003)">Censored Generalized Exponential model</a></li>
<li><a href="/examples/latest/reliability/Gompertz_Ex.html" title="Data from Murthy, Xie, and Jiang(2004)">Gompertz model</a></li>
<li><a href="/examples/latest/reliability/GPWeibull_Ex.html" title="'Carbon Fibres data' from Nichols and Padgett (2006) ">Two Parameter (GP) Exponentiated Weibull Example model</a></li>
<li><a href="/examples/latest/reliability/Gumbel_Ex.html" title="Data from Murthy, Xie, and Jiang(2004)">Gumbel model</a></li>
<li><a href="/examples/latest/reliability/Inv_Weibull_Ex.html" title="Data from Murthy, Xie, and Jiang(2004)">Inverse Weibull model</a></li>
<li><a href="/examples/latest/reliability/InvGaussian_Ex.html" title="'Transceiver data' from Chikara and Folks (9177)">Inverse Gaussian model</a></li>
<li><a href="/examples/latest/reliability/LinearFailure_Ex.html" title="Data from Murthy, Xie, and Jiang(2004)">Linear Failure Rate (LFR) model</a></li>
<li><a href="/examples/latest/reliability/LogisticExponential_Ex.html" title="'Naval logistics' data from Yan and Leemis (2008)">Logistic-Exponential model</a></li>
<li><a href="/examples/latest/reliability/Loglogistic_Ex.html" title="Simulated data">Log-Logistic model</a></li>
<li><a href="/examples/latest/reliability/LogWeibull_Ex.html" title="Data from Murthy, Xie, and Jiang(2004)">Log-Weibull model</a></li>
<li><a href="/examples/latest/reliability/ModifiedWeibull_Ex.html" title="Data from Aarset(1987)">Modified Weibull model</a></li>
<li><a href="/examples/latest/reliability/WeibullShifted_Ex.html" title="Simulated data">Weibull-shifted model</a></li>
</ul>
</li>
</li></li></li></li></ul>
</div>
</div></div><div class="col-12 col-md-9 col-lg-7 col-xl-6">


<p>
<h4>Lotka-Volterra: A simple differential equation model</h4><font color="#000100" face="CMR12" size="3">In this section we will take a look at the Lotka-Volterra system of equations<br/><br/></font><font color="#000100" face="CMMI12" size="3">      dx/dt </font><font color="#000100" face="CMR12" size="3">= </font><font color="#000100" face="CMMI12" size="3">x</font><font color="#000100" face="CMR12" size="3">(</font><font>α</font><font color="#000100" face="CMSY10" size="3">− </font><font>β</font><font color="#000100" face="CMMI12" size="3">y</font><font color="#000100" face="CMR12" size="3">)</font><font color="#000100" face="CMMI12" size="3">,      dy/dt </font><font color="#000100" face="CMR12" size="3">= </font><font color="#000100" face="CMSY10" size="3">−</font><font color="#000100" face="CMMI12" size="3">y</font><font color="#000100" face="CMR12" size="3">(</font><font>γ</font><font color="#000100" face="CMSY10" size="3">− </font><font>δ</font><font color="#000100" face="CMMI12" size="3">x</font><font color="#000100" face="CMR12" size="3">)<br/>      <br/>where </font><font>α</font><font color="#000100" face="CMMI12" size="3">, </font><font>β</font><font color="#000100" face="CMMI12" size="3">, </font><font>γ</font><font color="#000100" face="CMMI12" size="3">, </font><font>δ</font><font color="#000100" face="CMR12" size="3">are positive real quantities. For a simulation run we would specify the values of</font><font>α</font><font color="#000100" face="CMMI12" size="3">, </font><font>β</font><font color="#000100" face="CMMI12" size="3">, </font><font>γ</font><font color="#000100" face="CMMI12" size="3">, </font><font>δ </font><font color="#000100" face="CMR12" size="3">as constants, and for an inference run attempt to estimate their values from observations of </font><font color="#000100" face="CMMI12" size="3">x </font><font color="#000100" face="CMR12" size="3">and </font><font color="#000100" face="CMMI12" size="3">y</font>. Note that systems of differential equations do not require all variables to be observed to perform an inference computation; in more realistic cases we might only observe one variable of a system of many equations.<br/><br/>In the BUGS language the model is<br/><code><br/></code>model <br/>{<br/>solution[1:ngrid, 1:ndim] &lt;- ode.solution(init[1:ndim], tgrid[1:ngrid], D(C[1:ndim], t), <br/>origin, tol) <br/><br/>alpha &lt;- exp(log.alpha)<br/>beta &lt;- exp(log.beta) <br/>gamma &lt;- exp(log.gamma)<br/>delta &lt;- exp(log.delta) <br/>log.alpha ~ dnorm(0.0, 0.0001) <br/>log.beta ~ dnorm(0.0, 0.0001) <br/>log.gamma ~ dnorm(0.0, 0.0001) <br/>log.delta ~ dnorm(0.0, 0.0001) <br/><br/>D(C[1], t) &lt;- C[1] * (alpha - beta * C[2])<br/>D(C[2], t) &lt;- -C[2] * (gamma - delta * C[1])<br/>      <br/>for (i in 1:ngrid)<br/>{<br/>sol_x[i] &lt;- solution[i, 1]<br/>obs_x[i] ~ dnorm(sol_x[i], tau.x)<br/>sol_y[i] &lt;- solution[i, 2]<br/>obs_y[i] ~ dnorm(sol_y[i], tau.y)<br/>}<br/>      <br/>tau.x ~ dgamma(a, b)<br/>tau.y ~ dgamma(a, b) <br/>}<br/>   <br/><a href="/examples/latest/Lotka-Volterradata.html"></a><div><h5>Data</h5><details><code>
list(<br/>ndim = 2, <br/>origin = 0, <br/>tol = 1.0E-3, <br/>ngrid = 51, <br/>init = c(0.1, 0.1),<br/>tgrid = c(0.00000, 0.20000, 0.40000,0.60000,0.80000,1.00000, 1.20000, 1.40000, 1.60000, 1.80000, 2.00000, 2.20000, 2.40000, 2.60000, 2.80000, 3.00000, 3.20000, 3.40000, 3.60000, 3.80000, 4.0000, 4.20000, 4.40000, 4.60000, 4.80000, 5.00000, 5.20000, 5.40000, 5.60000, 5.80000, 6.00000, 6.20000, 6.40000, 6.60000, 6.80000, 7.00000, 7.20000, 7.40000, 7.60000, 7.80000, 8.00000, 8.20000, 8.40000, 8.60000, 8.80000, 9.00000, 9.20000, 9.40000, 9.60000, 9.80000, 10.00000), <br/>obs_x = c(<br/>-0.01608,-0.1708,-0.0192,0.2032,0.3486,<br/>-0.01108,0.315,0.6167,0.4196,0.5054,<br/>0.7239,1.068,0.8091,0.6691,1.346,<br/>1.218,2.309,2.2,3.277,3.208,<br/>4.597,5.637,5.185,4.994,2.669,<br/>0.7339,0.6815,0.2066,0.2027,0.2085,<br/>-0.08637,-0.1749,-0.3844,-0.2784,0.1318,<br/>-0.3821,0.04724,0.2159,-0.2631,-0.0816,<br/>0.08449,0.1473,-0.09645,0.09215,0.3158,<br/>-0.2747,0.3103,0.06757,0.1865,0.6497,<br/>0.2115),<br/>obs_y = c(<br/>-0.08858,0.1434,0.08245,-0.2407,0.1387,<br/>0.3802,0.1598,0.5153,0.5177,-0.2911,<br/>-0.08854,-0.1508,-0.5889,0.754,0.08401,<br/>0.06299,0.5945,0.553,0.6552,0.3397,<br/>0.5566,0.5873,1.304,2.533,4.639,<br/>5.462,5.215,4.756,3.819,2.679,<br/>2.772,2.633,2.009,1.57,1.205,<br/>0.572,0.7306,0.8157,0.6071,0.3905,<br/>0.33,0.3983,0.399,-0.1115,0.1113,<br/>-0.01252,0.8656,-0.3442,0.1883,0.445,<br/>0.1585),<br/>a = 0.001,<br/>b = 0.001<br/>)<br/>
</code></details></div><a href="/examples/latest/Lotka-Volterrainits.html"></a><div><h5>Inits for chain 1</h5><code>
list(<br/>log.alpha = 0.40, <br/>log.beta = -0.69, <br/>log.gamma = 0.40, <br/>log.delta = -0.30, <br/>tau.x = 0.01,<br/>tau.y = 0.01<br/>)
</code></div>    <a href="/examples/latest/Lotka-Volterrainits1.html"></a><div><h5>Inits for chain 2</h5><code>
list(<br/>log.alpha = 0.0, <br/>log.beta = 0.09, <br/>log.gamma = 0.0, <br/>log.delta = 0.0, <br/>tau.x = 0.1,<br/>tau.y = 0.1)<br/>
</code></div><br/><font color="#0000FF" face="Arial" size="5">Results</font><br/></p><center><code><br/><img alt="[lotka-volterra1]" src="lotka-volterra1.bmp"/><br/><br/><br/><br/><br/><img alt="[lotka-volterra2]" src="lotka-volterra2.bmp"/><br/><br/><img alt="[lotka-volterra3]" src="lotka-volterra3.bmp"/><br/></code></center>

<p></p>


</div><div class="d-none d-lg-block col-lg-3 col-xl-3" id="onthispage"><div class="sticky-top stickymenu"><h5>On this page</h5></div></div></div></div></body></html>