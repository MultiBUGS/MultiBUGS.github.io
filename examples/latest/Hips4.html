<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd">
<html><head>
<title>Hips4</title>

<link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" rel="stylesheet"/>
<script crossorigin="anonymous" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
<link href="/css/bootstrap.css" rel="stylesheet"/>
<link href="images/favicon.ico" rel="icon" type="image/x-icon"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
</head>
<body>
<nav class="navbar navbar-expand sticky-top navbar-light bg-light">
<a class="navbar-brand" href="/"><img src="/images/logo.svg"/>MultiBUGS</a>
<div class="collapse navbar" id="navbarSupportedContent">
<ul class="navbar-nav mr-auto">
<li class="nav-item">
<a class="nav-link" href="/">Home</a>
</li>
<li class="nav-item">
<a class="nav-link" href="/about">About</a>
</li>
<li class="nav-item">
<a class="nav-link" href="/download">Download</a>
</li>
<li class="nav-item">
<a class="nav-link" href="/documentation/latest/">Documentation</a>
</li>
<li class="nav-item active">
<a class="nav-link" href="/examples/latest/">Examples <span class="sr-only">(current)</span></a>
</li>
</ul>
</div>
</nav><div class="container-fluid"><div class="row main"><div class="col-md-3 col-lg-2 col-xl-3"><div class="sticky-top stickymenu" id="contents">
<button aria-controls="navbarContents" aria-expanded="false" aria-label="Toggle docs navigation" class="btn btn-link d-md-none ml-3 mr-3 mt-3 collapsed mb-toggler" data-target="#navbarContents" data-toggle="collapse" type="button">
<span class="mb-toggler-icon mr-1"></span>
    Contents
  </button>

<h5 class="d-none d-md-block">Examples</h5>
<div class="collapse mb-links" id="navbarContents">
<ul class="list-unstyled">
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#volume1">Volume I</a>
<ul class="collapse" id="volume1">
<li><a href="/examples/latest/Volumei.html">Contents</a></li>
<li><a href="/examples/latest/Rats.html" title="Normal hierarchical model">Rats</a></li>
<li><a href="/examples/latest/Pumps.html" title="Conjugate gamma-Poisson hierarchical model">Pumps</a></li>
<li><a href="/examples/latest/Dogs.html" title="Log linear binary model">Dogs</a></li>
<li><a href="/examples/latest/Seeds.html" title="Random effects logistic regression">Seeds</a></li>
<li><a href="/examples/latest/Surgical.html" title="Institutional ranking">Surgical</a></li>
<li><a href="/examples/latest/Magnesium.html" title="Meta-analysis prior sensitivity">Magnesium</a></li>
<li><a href="/examples/latest/Salm.html" title="Extra-Poisson variation in dose-response study">Salm</a></li>
<li><a href="/examples/latest/Equiv.html" title="Bioequivalence in a cross-over trial">Equiv</a></li>
<li><a href="/examples/latest/Dyes.html" title="Variance components model">Dyes</a></li>
<li><a href="/examples/latest/Stacks.html" title="Robust and ridge regression">Stacks</a></li>
<li><a href="/examples/latest/Epil.html" title="Repeated measures on Poisson counts">Epil</a></li>
<li><a href="/examples/latest/Blockers.html" title="Random effects meta-analysis of clinical trials">Blockers</a></li>
<li><a href="/examples/latest/Oxford.html" title="Smooth fit to log-odds ratios in case control studies">Oxford</a></li>
<li><a href="/examples/latest/Lsat.html" title="Latent variable models for item-response data">LSAT</a></li>
<li><a href="/examples/latest/Bones.html" title="Latent trait model for multiple ordered categorical responses">Bones</a></li>
<li><a href="/examples/latest/Inhalers.html" title="Random effects model for ordinal responses from a cross-over trial">Inhalers</a></li>
<li><a href="/examples/latest/Mice.html" title="Weibull regression in censored survival analysis">Mice</a></li>
<li><a href="/examples/latest/Kidney.html" title="Weibull regression with random effects">Kidney</a></li>
<li><a href="/examples/latest/Leuk.html" title="Survival analysis using Cox regression">Leuk</a></li>
<li><a href="/examples/latest/Leukfr.html" title="Cox regression with frailties">LeukFr</a></li>
</ul>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#volume2">Volume II</a>
<ul class="collapse" id="volume2">
<li><a href="/examples/latest/Volumeii.html">Contents</a></li>
<li><a href="/examples/latest/Dugongs.html" title="A nonconjugate, nonlinear model">Dugongs</a></li>
<li><a href="/examples/latest/Otrees.html" title="A hierarchical, nonlinear model">Orange trees</a></li>
<li><a href="/examples/latest/OtreesMVN.html" title="A hierarchical, nonlinear model">MV Orange trees</a></li>
<li><a href="/examples/latest/Biopsies.html" title="Latent class model">Biopsies</a></li>
<li><a href="/examples/latest/Eyes.html" title="Normal mixture model">Eyes</a></li>
<li><a href="/examples/latest/Hearts.html" title="A mixture model for count data">Hearts</a></li>
<li><a href="/examples/latest/Air.html" title="Covariate measurement error">Air</a></li>
<li><a href="/examples/latest/Cervix.html" title="Case-control study with errors in covariates">Cervix</a></li>
<li><a href="/examples/latest/Jaws.html" title="Repeated measures analysis of variance">Jaw</a></li>
<li><a href="/examples/latest/BiRats.html" title="A bivariate Normal hierarchical model">Birats</a></li>
<li><a href="/examples/latest/Schools.html" title="Multivariate hierarchical model of examination results">Schools</a></li>
<li><a href="/examples/latest/Ice.html" title="Non-parametric smoothing in an age-cohort model">Ice</a></li>
<li><a href="/examples/latest/Beetles.html" title="Logistic, probit and extreme value models">Beetles</a></li>
<li><a href="/examples/latest/Alligators.html" title="Multinomial logistic model">Alligators</a></li>
<li><a href="/examples/latest/Endo.html" title="Conditional inference in case-control studies">Endo</a></li>
<li><a href="/examples/latest/Stagnant.html" title="A change point problem">Stagnant</a></li>
<li><a href="/examples/latest/Asia.html" title="An expert system">Asia</a></li>
<li><a href="/examples/latest/Pigs.html" title="Genetic counseling and pedigree analysis">Pigs</a></li>
<li><a href="/examples/latest/t-df.html" title="Degree of freedom of a t distribution">Simulating data</a></li>
</ul>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#volume3">Volume III</a>
<ul class="collapse show" id="volume3">
<li><a href="/examples/latest/Volumeiii.html">Contents</a></li>
<li><a href="/examples/latest/Camel.html" title="Multivariate normal with structured missing data">Camel</a></li>
<li><a href="/examples/latest/Eyetracking.html" title="Dirichlet process prior">Eye Tracking</a></li>
<li><a href="/examples/latest/Fire.html" title="Data distribution using dloglik">Fire insurance claims</a></li>
<li><a href="/examples/latest/Funshapes.html" title="General constraints">Fun Shapes</a></li>
<li><a href="/examples/latest/Hepatitis.html" title="Random effects model with measurement error">Hepatitis</a></li>
<li><a href="/examples/latest/Hips1.html" title="Deterministic cost-effectiveness model">Hips1</a></li>
<li><a href="/examples/latest/Hips2.html" title="Stochastic cost-effectiveness model">Hips2</a></li>
<li><a href="/examples/latest/Hips3.html" title="Cost-effectiveness model">Hips3</a></li>
<li>Hips4</li>
<li><a href="/examples/latest/Jama.html" title="Radio carbon dating with phase information">Jama</a></li>
<li><a href="/examples/latest/Pigweights.html" title="Smoothed histogram">Pig Weights</a></li>
<li><a href="/examples/latest/Pines.html" title="Bayes factors using pseudo priors">Pines</a></li>
<li><a href="/examples/latest/StVeit.html" title="Radio carbon dating with stratification">St Veit</a></li>
</ul>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#volume4">Volume IV</a>
<ul class="collapse" id="volume4">
<li><a href="/examples/latest/Volumeiv.html">Contents</a></li>
<li><a href="/examples/latest/SeedsDataCloning.html" title="Estimating MLEs">Seeds</a></li>
<li><a href="/examples/latest/Coins.html" title="The ABC">Coins</a></li>
<li><a href="/examples/latest/SmartPhones.html" title="A bootstrap approach">Smart phones</a></li>
<li><a href="/examples/latest/Abbey.html" title="Share prices a stable approach">Abbey</a></li>
<!--<li><a href="/examples/latest/BeetlesMLE.html" title="Differential evolution and MLEs">Beetles</a></li>-->
<li><a href="/examples/latest/BeetlesProbit.html" title="Probit regression and censoring">Beetles</a></li>
<li><a href="/examples/latest/Preeclampsia.html" title="A multistage approach">Preeclampsia</a></li>
<li><a href="/examples/latest/Lotka-Volterra.html" title="A simple ODE model">Lotka-Volterra</a></li>
<li><a href="/examples/latest/FiveCompartment.html" title="A complex ODE model">Five compartment</a></li>
<li><a href="/examples/latest/ChangePoints.html" title="An ODE model with change points">Change points</a></li>
<li><a href="/examples/latest/Pollution.html" title="An autoregressive time series model">Pollution</a></li>
<li><a href="/examples/latest/Methadone.html" title="A large e-health random effects model">Methadone</a></li>
<li><a href="/examples/latest/Functionals.html" title="Integration and algebraic equations">Functionals</a></li>
</ul>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#ecology">Ecology</a>
<ul class="collapse" id="ecology">
<li><a href="/examples/latest/VolumeEco.html">Contents</a></li>
<li><a href="/examples/latest/Gentians.html" title="Imperfect detection in site occppancy">Gentians</a></li>
<li><a href="/examples/latest/Sparrowhawk.html" title="Generalised metapopulation model">Sparrowhawks</a></li>
<li><a href="/examples/latest/Birds.html" title="Estimating species richness">Birds</a></li>
<li><a href="/examples/latest/Lizards.html" title="Mixture model for abundance with imperfect detection">Lizards</a></li>
<li><a href="/examples/latest/Voles.html" title="Estimating size of closed population">Voles</a></li>
<li><a href="/examples/latest/Impala.html" title="Distance sampling">Impala</a></li>
</ul>
</li>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#geobugs">GeoBUGS</a>
<ul class="collapse" id="geobugs">
<li><a href="/examples/latest/spatial/Examples.html">Contents</a></li>
<li><a href="/examples/latest/spatial/Scotland.html" title="Lip cancer in Scotland">Conditional Autoregressive (CAR) models for disease mapping</a></li>
<li><a href="/examples/latest/spatial/LHA.html" title="Lung cancer in a London Health Authority">Convolution priors</a></li>
<li><a href="/examples/latest/spatial/Scotland1.html" title="Lip cancer revisited">Proper CAR model</a></li>
<li><a href="/examples/latest/spatial/Elevation.html" title="Surface elevation">Bayesian kriging and spatial prediction</a></li>
<li><a href="/examples/latest/spatial/Forest.html" title="Distribution of hickory trees in Duke forest">Poisson-gamma spatial moving average (convolution) model</a></li>
<li><a href="/examples/latest/spatial/Huddersfield.html" title="Ecological regression of air pollution and respiratory illness in children">Poisson-gamma spatial moving average (convolution) model</a></li>
<li><a href="/examples/latest/spatial/Shared.html" title="Oral cavity cancer and lung cancer in West Yorkshire (UK)">Shared component for mapping multiple diseases</a></li>
<li><a href="/examples/latest/spatial/Pollution.html">Random walk priors for temporal smoothing of daily air pollution estimates</a></li>
</ul>
</li>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#reliability">ReliaBUGS</a>
<ul class="collapse" id="reliability">
<li><a href="/examples/latest/reliability/Vol.html">Contents</a></li>
<li><a href="/examples/latest/reliability/BS_Ex.html" title="'psi31' data from B&amp;S(1969)">Birnbuam-Saunders model</a></li>
<li><a href="/examples/latest/reliability/BurrX_Ex.html" title="'Ball bearing' data from Lawless(2003)">BurrX model</a></li>
<li><a href="/examples/latest/reliability/BurrXII_Ex.html" title="Simulated example ">BurrXII model</a></li>
<li><a href="/examples/latest/reliability/ExpoWeibull_Ex.html" title="Carbon Fibres data from Nichols and Padgett (2006) ">Two Parameter Exponentiated Weibull Example model</a></li>
<li><a href="/examples/latest/reliability/ExpPower_Ex.html" title="'Simulated data">Exponential Power model</a></li>
<li><a href="/examples/latest/reliability/Ext_exponential_Ex.html" title="'Carbon Fibres data' from Nichols and Padgett (2006)">Marshal-Olkin Extended Exponential (MOEE) model</a></li>
<li><a href="/examples/latest/reliability/Ext_Weibull_Ex.html" title="'Device failure times data' from Meeker and Escobar(1998)">Marshal-Olkin Extended Weibull model</a></li>
<li><a href="/examples/latest/reliability/FlexibleWeibull_Ex.html" title="'Reactor pump failure data' from Bebbinton, Lai, and Zitikis(2007)">Flexible Weibull model</a></li>
<li><a href="/examples/latest/reliability/GenExponential_Cen_Ex.html" title="'Ball bearing' data from Lawless(2003)">Censored Generalized Exponential model</a></li>
<li><a href="/examples/latest/reliability/Gompertz_Ex.html" title="Data from Murthy, Xie, and Jiang(2004)">Gompertz model</a></li>
<li><a href="/examples/latest/reliability/GPWeibull_Ex.html" title="'Carbon Fibres data' from Nichols and Padgett (2006) ">Two Parameter (GP) Exponentiated Weibull Example model</a></li>
<li><a href="/examples/latest/reliability/Gumbel_Ex.html" title="Data from Murthy, Xie, and Jiang(2004)">Gumbel model</a></li>
<li><a href="/examples/latest/reliability/Inv_Weibull_Ex.html" title="Data from Murthy, Xie, and Jiang(2004)">Inverse Weibull model</a></li>
<li><a href="/examples/latest/reliability/InvGaussian_Ex.html" title="'Transceiver data' from Chikara and Folks (9177)">Inverse Gaussian model</a></li>
<li><a href="/examples/latest/reliability/LinearFailure_Ex.html" title="Data from Murthy, Xie, and Jiang(2004)">Linear Failure Rate (LFR) model</a></li>
<li><a href="/examples/latest/reliability/LogisticExponential_Ex.html" title="'Naval logistics' data from Yan and Leemis (2008)">Logistic-Exponential model</a></li>
<li><a href="/examples/latest/reliability/Loglogistic_Ex.html" title="Simulated data">Log-Logistic model</a></li>
<li><a href="/examples/latest/reliability/LogWeibull_Ex.html" title="Data from Murthy, Xie, and Jiang(2004)">Log-Weibull model</a></li>
<li><a href="/examples/latest/reliability/ModifiedWeibull_Ex.html" title="Data from Aarset(1987)">Modified Weibull model</a></li>
<li><a href="/examples/latest/reliability/WeibullShifted_Ex.html" title="Simulated data">Weibull-shifted model</a></li>
</ul>
</li>
</li></li></li></li></ul>
</div>
</div></div><div class="col-12 col-md-9 col-lg-7 col-xl-6">


<p>
<h4>Hips model 4: Comparative analysis of Stanmore &amp; Charnley incorporating evidence</h4>Spiegelhalter, D.J. and Best, N.G. “Bayesian approaches to multiple sources of evidence and uncertainty in complex cost-effectiveness modelling”. <u>Statistics in Medicine 22</u>, (2003), 3687-3709.<br/>n = 10000 updates (1 per simulated set of parameter values) are required for this model; <br/>For hazard ratio estimates in bottom of table 4, monitor HR. For results in table 5, monitor C.incr, BQ.incr, ICER.strata, mean.C.incr, mean.BQ.incr, mean.ICER, P.CEA.strata[30,],<br/>P.CEA.strata[50,], P.CEA[30] and P.CEA[50]. To produce plots in Fig 2, use coda option to save samples of C.incr, BQ.incr, mean.C.incr, mean.BQ.incr. To produce plots in Fig 3, set summary monitors on P.CEA.strata and P.CEA to get posterior means<br/><span class="button"><br/></span><strong>Sections of the code that have changed from Model 1 are shown in bold<br/></strong><font color="#000100" face="Arial" size="2">model {<br/><br/></font><font color="#000000" face="Arial" size="2"><strong># Evidence<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>#########<br/><br/></strong></font><font color="#000000" face="Arial" size="2"><strong>for (i in 1 : M){ # loop over studies<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>rC[i] ~ dbin(pC[i], nC[i]) # number of revisions on Charnley<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>rS[i] ~ dbin(pS[i], nS[i]) # number of revisions on Stanmore<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>cloglog(pC[i]) &lt;- base[i] - logHR[i]/2 <br/></strong></font><font color="#000000" face="Arial" size="2"><strong>cloglog(pS[i]) &lt;- base[i] + logHR[i]/2 <br/></strong></font><font color="#000000" face="Arial" size="2"><strong>base[i] ~ dunif(-100,100) <br/></strong></font><font color="#000000" face="Arial" size="2"><strong># log hazard ratio for ith study<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>logHR[i] ~ dnorm(LHR,tauHR[i]) <br/></strong></font><font color="#000000" face="Arial" size="2"><strong>tauHR[i] &lt;- qualweights[i] * tauh # precision for ith study weighted by quality weights<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>} <br/></strong></font><font color="#000000" face="Arial" size="2"><strong>LHR ~ dunif(-100,100) <br/></strong></font><font color="#000000" face="Arial" size="2"><strong>log(HR) &lt;- LHR <br/></strong></font><font color="#000000" face="Arial" size="2"><strong>tauh &lt;- 1 / (sigmah * sigmah) <br/></strong></font><font color="#000000" face="Arial" size="2"><strong>sigmah ~ dnorm( 0.2, 400)T(0, ) # between-trial sd = 0.05 (prior constrained to be positive)<br/><br/></strong></font><font color="#000000" face="Arial" size="2"><strong>for(k in 1 : K) { <br/></strong></font><font color="#000000" face="Arial" size="2"><strong>logh[k] ~ dnorm(logh0[k], tau)<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>h[1, k] &lt;- exp(logh[k]) # revision hazard for Charnley<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>h[2, k] &lt;- HR * h[1, k] # revision hazard for Stanmore<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>}</strong></font># Cost-effectiveness model<br/><font color="#000100" face="Arial" size="2">###################### <br/><br/></font><font color="#000100" face="Arial" size="2">for(k in 1 : K) { # loop over strata<br/><br/></font><font color="#000000" face="Arial" size="2"><strong>for(n in 1 : 2) { # loop over protheses<br/></strong></font># Cost and benefit equations in closed form:<br/><font color="#000100" face="Arial" size="2">####################################<br/><br/></font># Costs<br/>for(t in 1 : N) {<br/>   ct[n, k, t] &lt;- inprod(pi[n, k, t, ], c[n, ]) / pow(1 + delta.c, t - 1)<br/>} <br/><font color="#000100" face="Arial" size="2">C[n,k] &lt;- C0[n] + sum(ct[n, k, ])<br/><br/></font># Benefits - life expectancy<br/>for(t in 1 : N) {<br/>   blt[n, k, t] &lt;- inprod(pi[n, k, t, ], bl[]) / pow(1 + delta.b, t - 1)<br/>} <br/><font color="#000100" face="Arial" size="2">BL[n, k] &lt;- sum(blt[n, k, ])<br/><br/></font># Benefits - QALYs<br/>for(t in 1 : N) {<br/>   bqt[n, k, t] &lt;- inprod(pi[n, k, t, ], bq[]) / pow(1 + delta.b, t - 1)<br/>} <br/><font color="#000100" face="Arial" size="2">BQ[n, k] &lt;- sum(bqt[n, k, ])<br/><br/></font># Markov model probabilities:<br/><font color="#000100" face="Arial" size="2">#######################<br/><br/></font># Transition matrix<br/>for(t in 2:N) {<br/>Lambda[n, k, t, 1, 1] &lt;- 1 - gamma[n, k, t] - lambda[k, t]<br/>Lambda[n, k, t, 1, 2] &lt;- gamma[n, k, t] * lambda.op<br/>Lambda[n, k, t, 1, 3] &lt;- gamma[n, k, t] *(1 - lambda.op)<br/>Lambda[n, k, t, 1, 4] &lt;- 0<br/><font color="#000100" face="Arial" size="2">Lambda[n, k, t, 1, 5] &lt;- lambda[k, t] <br/><br/></font>Lambda[n, k, t, 2, 1] &lt;- 0<br/>Lambda[n, k, t, 2, 2] &lt;- 0 <br/>Lambda[n, k, t, 2, 3] &lt;- 0 <br/>Lambda[n, k, t, 2, 4] &lt;- 0 <br/><font color="#000100" face="Arial" size="2">Lambda[n, k ,t, 2, 5] &lt;- 1 <br/><br/></font>Lambda[n, k, t, 3, 1] &lt;- 0<br/>Lambda[n, k, t, 3, 2] &lt;- 0 <br/>Lambda[n, k, t, 3, 3] &lt;- 0<br/>Lambda[n, k, t, 3, 4] &lt;- 1 - lambda[k, t]<br/><font color="#000100" face="Arial" size="2">Lambda[n, k, t, 3, 5] &lt;- lambda[k, t]<br/><br/></font>Lambda[n, k, t, 4, 1] &lt;- 0<br/>Lambda[n, k, t, 4, 2] &lt;- rho * lambda.op<br/>Lambda[n, k, t, 4, 3] &lt;- rho * (1 - lambda.op)<br/>Lambda[n, k, t, 4, 4] &lt;- 1 - rho - lambda[k, t]<br/><font color="#000100" face="Arial" size="2">Lambda[n, k, t, 4, 5] &lt;- lambda[k, t]<br/><br/></font>Lambda[n, k, t, 5, 1] &lt;- 0<br/>Lambda[n, k, t, 5, 2] &lt;- 0 <br/>Lambda[n, k, t, 5, 3] &lt;- 0<br/>Lambda[n, k, t, 5, 4] &lt;- 0<br/><font color="#000100" face="Arial" size="2">Lambda[n, k, t, 5, 5] &lt;- 1<br/><br/></font>gamma[n, k, t] &lt;- h[n, k] * (t - 1)<br/><font color="#000100" face="Arial" size="2">   }<br/><br/></font># Marginal probability of being in each state at time 1<br/>pi[n, k, 1, 1] &lt;- 1 - lambda.op pi[n, k, 1, 2] &lt;- 0 pi[n, k, 1, 3] &lt;- 0 <br/><font color="#000100" face="Arial" size="2">         pi[n, k, 1, 4] &lt;- 0 pi[n, k, 1, 5] &lt;- lambda.op<br/><br/></font># Marginal probability of being in each state at time t&gt;1<br/>for(t in 2 : N) {<br/>for(s in 1 : S) {<br/>   pi[n, k,t, s] &lt;- inprod(pi[n, k, t - 1, ], Lambda[n, k, t, , s])<br/>}<br/>}<br/>}<br/><font color="#000100" face="Arial" size="2">}<br/><br/></font><font color="#000000" face="Arial" size="2"><strong># Incremental costs and benefits<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>##########################<br/><br/></strong></font><font color="#000000" face="Arial" size="2"><strong>for(k in 1 : K) {<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>C.incr[k] &lt;- C[2, k] - C[1, k]<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>BQ.incr[k] &lt;-BQ[2, k] - BQ[1, k]<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>ICER.strata[k] &lt;- C.incr[k] / BQ.incr[k]<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>} <br/><br/></strong></font><font color="#000000" face="Arial" size="2"><strong># Probability of cost effectiveness @ KK pounds per QALY<br/></strong></font><font color="#000000" face="Arial" size="2"><strong># (values of KK considered range from 200 to 20000 in 200 pound increments)<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>for(m in 1 : 100) {<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>for(k in 1 : 12) { <br/></strong></font><font color="#000000" face="Arial" size="2"><strong>   P.CEA.strata[m,k] &lt;- step(KK[m] * BQ.incr[k] - C.incr[k])<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>}<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>   P.CEA[m] &lt;- step(KK[m] * mean.BQ.incr - mean.C.incr)<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>}<br/><br/></strong></font><font color="#000000" face="Arial" size="2"><strong># overall incremental costs and benefit <br/></strong></font><font color="#000000" face="Arial" size="2"><strong>for(n in 1 : 2) {<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>mean.C[n] &lt;- inprod(p.strata[], C[n, ])<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>mean.BQ[n] &lt;- inprod(p.strata[], BQ[n, ])<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>}<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>mean.C.incr &lt;- mean.C[2] - mean.C[1]<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>mean.BQ.incr &lt;- mean.BQ[2] - mean.BQ[1]<br/></strong></font><font color="#000000" face="Arial" size="2"><strong>mean.ICER &lt;- mean.C.incr / mean.BQ.incr </strong></font>}<br/><a href="/examples/latest/Hipsdata4.html"></a><div><h5>Data</h5><details><code>
list(N = 60, # Number of cycles<br/>K = 12, # Number of age-sex strata<br/>S = 5, # Number of states in Markov model<br/>M = 3, # Number of studies in evidence synthesis<br/>rho = 0.04, # re-revision rate<br/>lambda.op = 0.01, # post-operative mortality rate<br/># age-sex specific mean revision hazard for Charnley:<br/>logh0 = c(-6.119, -6.119, -6.119, -6.438, -6.438, -6.438, -6.377, -6.377, -6.377, -6.725, -6.725, -6.725), <br/>tau = 25,<br/>C0 = c(4052, 4402), # set-up costs of primary operation<br/>c = structure(.Data = c(0, 5290, 5290, 0, 0, <br/>0, 5640, 5640, 0, 0), .Dim=c(2,5)), # additional costs associated with each state and prothesis <br/># (zero except for revision states 2 and 3) <br/>bl = c(1,0,1,1,0), # life-expectancy benefits associated with each state (one except for death states 2 and 5)<br/>bq = c(0.938, -0.622, -0.3387, 0.938, 0), # QALYs associated with each state<br/>delta.c = 0.06, # cost discount<br/>delta.b = 0.06, # health discount<br/># delta.b = 0.015, # alternative health discount (for sensitivity analysis)<br/># probablilty of hip replacement by age and sex<br/>p.strata = c(0.02, 0.03, 0.07, 0.13, 0.10, 0.00, 0.02, 0.04, 0.10, 0.22, 0.26, 0.01),<br/>lambda = structure(.Data = c(0.0017, 0.0017, 0.0017, 0.0017, 0.0017, 0.0044, 0.0044, <br/>   0.0044, 0.0044, 0.0044, 0.0044, 0.0044, 0.0044, 0.0044, 0.0044, 0.0138,<br/>   0.0138, 0.0138, 0.0138, 0.0138, 0.0138, 0.0138, 0.0138, 0.0138, 0.0138,<br/>   0.0379, 0.0379, 0.0379, 0.0379, 0.0379, 0.0379, 0.0379, 0.0379, 0.0379,<br/>   0.0379, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912,<br/>   0.0912, 0.0912, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.0044,<br/>   0.0044, 0.0044, 0.0044, 0.0044, 0.0138, 0.0138, 0.0138, 0.0138, 0.0138,<br/>   0.0138, 0.0138, 0.0138, 0.0138, 0.0138, 0.0379, 0.0379, 0.0379, 0.0379,<br/>   0.0379, 0.0379, 0.0379, 0.0379, 0.0379, 0.0379, 0.0912, 0.0912, 0.0912,<br/>   0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.0138, 0.0138, 0.0138, 0.0138,<br/>   0.0138, 0.0379, 0.0379, 0.0379, 0.0379, 0.0379, 0.0379, 0.0379, 0.0379,<br/>   0.0379, 0.0379, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912,<br/>   0.0912, 0.0912, 0.0912, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.0379, 0.0379, 0.0379, 0.0379, 0.0379, 0.0912, 0.0912,<br/>   0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.0912, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.0912,<br/>   0.0912, 0.0912, 0.0912, 0.0912, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958, 0.1958,<br/>   0.1958, 0.1958, 0.0011, 0.0011, 0.0011, 0.0011, 0.0011, 0.0028, 0.0028,<br/>   0.0028, 0.0028, 0.0028, 0.0028, 0.0028, 0.0028, 0.0028, 0.0028, 0.0081,<br/>   0.0081, 0.0081, 0.0081, 0.0081, 0.0081, 0.0081, 0.0081, 0.0081, 0.0081,<br/>   0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, <br/>   0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.0578,<br/>   0.0578, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.0028, 0.0028,<br/>   0.0028, 0.0028, 0.0028, 0.0081, 0.0081, 0.0081, 0.0081, 0.0081, 0.0081,<br/>   0.0081, 0.0081, 0.0081, 0.0081, 0.022, 0.022, 0.022, 0.022, 0.022, <br/>   0.022, 0.022, 0.022, 0.022, 0.022, 0.0578, 0.0578, 0.0578, 0.0578, <br/>   0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.0081, 0.0081, 0.0081, 0.0081, 0.0081,<br/>   0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, 0.022, <br/>   0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.0578,<br/>   0.0578, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.022, 0.022, 0.022, 0.022, 0.022, 0.0578, 0.0578, 0.0578, 0.0578, <br/>   0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.0578, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.0578, 0.0578, 0.0578,<br/>   0.0578, 0.0578, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503,<br/>   0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503, 0.1503<br/>   ), .Dim=c(12,60)),<br/>   # Amount health care provider is willing to pay for each additional QALY <br/>   KK = c(200, 400, 600, 800, 1000, 1200, 1400, 1600, 1800, 2000, 2200, 2400, 2600, 2800, 3000, 3200, 3400, 3600, 3800, 4000,<br/>4200, 4400, 4600, 4800, 5000, 5200, 5400, 5600, 5800, 6000, 6200, 6400, 6600, 6800, 7000, 7200, 7400, 7600, 7800, 8000,<br/>8200, 8400, 8600, 8800, 9000, 9200, 9400, 9600, 9800, 10000, 10200, 10400, 10600, 10800, 11000, <br/>11200, 11400, 11600, 11800, 12000, 12200, 12400, 12600, 12800, 13000, 13200, 13400, 13600, 13800, 14000,<br/>14200, 14400, 14600, 14800, 15000, 15200, 15400, 15600, 15800, 16000, 16200, 16400, 16600, 16800, 17000, <br/>17200, 17400, 17600, 17800, 18000, 18200, 18400, 18600, 18800, 19000, 19200, 19400, 19600, 19800, 20000),<br/># Evidence<br/>rC = c(1683, 7, 33), # number of revisions for each study (Charnley)<br/>nC = c(28525, 200, 208), # number of operations for each study (Charnley)<br/>rS = c(28, 9, 69), # number of revisions for each study (Stanmore)<br/>nS = c(865, 213, 982), # number of operations for each study (Stanmore)<br/># Quality weights for each study<br/>qualweights = c(0.5, 1, 0.2)<br/># qualweights = c(0.1, 1, 0.05) # alternative quality weights for sensitivity analysis<br/>)<br/>
</code></details></div><a href="/examples/latest/Hips4inits.html"></a><div><h5>Inits for chain 1</h5><code>
list(base=c(-3.09,-3.25,-2.12),logHR=c(-0.63,0.15,-0.92),LHR=-0.35) 
</code></div>    <a href="/examples/latest/Hips4inits1.html"></a><div><h5>Inits for chain 2</h5><code>
list(base=c(0,0,0),logHR=c(1,1,1),LHR=1) 
</code></div><font color="#0000FF" face="Arial" size="5">Results</font><font color="#000100" face="Arial" size="1"><br/><br/>(quality weights c(0.5, 1, 0.2), delta.c = 0.06, delta.b = 0.06)<br/></font></p><center><font color="#000100" face="Arial" size="1"><br/><img alt="[hips41]" src="hips41.bmp"/><br/></font></center>

<p></p>


</div><div class="d-none d-lg-block col-lg-3 col-xl-3" id="onthispage"><div class="sticky-top stickymenu"><h5>On this page</h5></div></div></div></div></body></html>