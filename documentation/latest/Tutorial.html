<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd">
<html><head>
<title>Tutorial</title>

<link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" rel="stylesheet"/>
<script crossorigin="anonymous" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
<link href="/css/bootstrap.css" rel="stylesheet"/>
<link href="images/favicon.ico" rel="icon" type="image/x-icon"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
</head>
<body>
<nav class="navbar navbar-expand sticky-top navbar-light bg-light">
<a class="navbar-brand" href="/"><img src="/images/logo.svg"/>MultiBUGS</a>
<div class="collapse navbar" id="navbarSupportedContent">
<ul class="navbar-nav mr-auto">
<li class="nav-item">
<a class="nav-link" href="/">Home</a>
</li>
<li class="nav-item">
<a class="nav-link" href="/about">About</a>
</li>
<li class="nav-item">
<a class="nav-link" href="/download">Download</a>
</li>
<li class="nav-item active">
<a class="nav-link" href="/documentation/latest/">Documentation <span class="sr-only">(current)</span></a>
</li>
<li class="nav-item">
<a class="nav-link" href="/examples/latest/">Examples</a>
</li>
</ul>
</div>
</nav><div class="container-fluid"><div class="row main"><div class="col-md-3 col-lg-2 col-xl-3"><div class="sticky-top stickymenu" id="contents">
<button aria-controls="navbarContents" aria-expanded="false" aria-label="Toggle docs navigation" class="btn btn-link d-md-none ml-3 mr-3 mt-3 collapsed mb-toggler" data-target="#navbarContents" data-toggle="collapse" type="button">
<span class="mb-toggler-icon mr-1"></span>
    Contents
  </button>

<h5 class="d-none d-md-block">Contents</h5>
<div class="collapse mb-links" id="navbarContents">
<ul class="list-unstyled">
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#basics">Basics</a>
<ul class="collapse show" id="basics">
<li><a href="/documentation/latest/Introduction.html">Introduction</a></li>
<li>Tutorial</li>
<li><a href="/documentation/latest/CompoundDocuments.html">Compound documents</a></li>
<li><a href="/documentation/latest/Graphics.html">Graphics</a></li>
<li><a href="/documentation/latest/DoodleBUGS.html">DoodleBUGS</a></li>
<li><a href="/documentation/latest/Scripts.html">Scripts</a></li>
</ul>
</li>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#language">BUGS language</a>
<ul class="collapse" id="language">
<li><a href="/documentation/latest/ModelSpecification.html">Model specification</a></li>
<li><a href="/documentation/latest/Distributions.html">Distributions</a></li>
<li><a href="/documentation/latest/Functions.html">Functions and functionals</a></li>
<li><a href="/documentation/latest/Tricks.html">Advanced uses</a></li>
<li><a href="/documentation/latest/TipsTroubleshooting.html">Tips and troubleshooting</a></li>
</ul>
</li>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#menus">Menus</a>
<ul class="collapse" id="menus">
<li><a href="/documentation/latest/FileMenu.html">File</a></li>
<li><a href="/documentation/latest/EditMenu.html">Edit</a></li>
<li><a href="/documentation/latest/AttributesMenu.html">Attributes</a></li>
<li><a href="/documentation/latest/ToolsMenu.html">Tools</a></li>
<li><a href="/documentation/latest/TextMenu.html">Text</a></li>
<li><a href="/documentation/latest/InfoMenu.html">Info</a></li>
<li><a href="/documentation/latest/ModelMenu.html">Model</a></li>
<li><a href="/documentation/latest/InferenceMenu.html">Inference</a></li>
<li><a href="/documentation/latest/DoodleMenu.html">Doodle</a></li>
<li><a href="/documentation/latest/MapMenu.html">Map</a></li>
<li><a href="/documentation/latest/ExamplesMenu.html">Examples</a></li>
<li><a href="/documentation/latest/ManualsMenu.html">Manuals</a></li>
<li><a href="/documentation/latest/HelpMenu.html">Help</a></li>
</ul>
</li>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#geobugs">GeoBUGS</a>
<ul class="collapse" id="geobugs">
<li><a href="/documentation/latest/spatial/Manual.html">Introduction</a></li>
<li><a href="/documentation/latest/spatial/ImportExport.html">Importing/exporting maps</a></li>
<li><a href="/documentation/latest/spatial/AdjacencyMatrices.html">Adjacency matrices</a></li>
<li><a href="/documentation/latest/spatial/Maps.html">Creating maps</a></li>
<li><a href="/documentation/latest/spatial/SpatialDistributions.html">Spatial distributions</a></li>
<li><a href="/documentation/latest/spatial/TemporalDistributions.html">Temporal distributions</a></li>
</ul>
</li>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#reliability">ReliaBUGS</a>
<ul class="collapse" id="reliability">
<li><a href="/documentation/latest/reliability/Contents.html">Introduction</a></li>
<li><a href="/documentation/latest/reliability/Analysis.html">Basics</a></li>
<li><a href="/documentation/latest/reliability/Distributions.html">Distributions</a></li>
<li><a href="/documentation/latest/reliability/Functions.html">Logical functions</a></li>
<li><a href="/documentation/latest/reliability/References.html">References</a></li>
</ul>
</li>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#developer">Developer</a>
<ul class="collapse" id="developer">
<li><a href="/documentation/latest/developer/Manual.html">Contents</a></li>
<li><a href="/documentation/latest/developer/Tools.html">Setting up the development tools</a></li>
<li><a href="/documentation/latest/developer/Compiling.html">Compiling the Source Code</a></li>
<li><a href="/documentation/latest/developer/Initializing.html">Initializing OpenBUGS</a></li>
<li><a href="/documentation/latest/developer/WritingBUGSExtensions.html">Writing OpenBUGS extensions</a></li>
<li><a href="/documentation/latest/developer/SamplingAlgorithms.html">Sampling algorithms</a></li>
<li><a href="/documentation/latest/developer/BlueDiamonds.html">Blue diamonds</a></li>
<li><a href="/documentation/latest/developer/SoftDocu.html">Bugs subsystems</a></li>
<li><a href="/documentation/latest/developer/Distributing.html">Distributing OpenBUGS</a></li>
</ul>
</li>
<!--<li><a href="/documentation/latest/References.html">References</a>-->
</ul>
</div>
</div></div><div class="col-12 col-md-9 col-lg-7 col-xl-6">


<p>
<h4>Tutorial</h4><h5 id="Introduction">Introduction</h5>This tutorial is designed to provide new users with a step-by-step guide to running an analysis in BUGS. It is not intended to be prescriptive, but rather to introduce you to the main tools needed to run an MCMC simulation in BUGS, and give some guidance on appropriate usage of the software.<br/><br/>The <a href="/examples/latest/Seeds.html">Seeds</a><a href="/examples/latest/Seeds.html"></a> example from Volume I of the BUGS examples will be used throughout this tutorial. This example is taken from Table 3 of Crowder (1978) and concerns the proportion of seeds that germinated on each of 21 plates arranged according to a 2 by 2 factorial layout by seed and type of root extract. The data are shown below, where r<sub>i</sub> and n<sub>i</sub> are the number of germinated and the total number of seeds on the i<sup>th</sup> plate, i = 1, ..., N. These data are also analysed by, for example, Breslow and Clayton (1993).<br/><br/><font color="#000100" face="Arial" size="2"><img alt="[tutorial1]" src="tutorial1.bmp"/></font><br/><br/>The model is essentially a random effects logistic regression, allowing for over-dispersion. If <em>p</em><em><sub>i</sub></em> is the probability of germination on the i<sup>th</sup> plate, we assume<br/><br/>   <em>r</em><em><sub>i</sub></em> ~ Binomial(<em>p</em><em><sub>i</sub></em>, <em>n</em><em><sub>i</sub></em>)<br/>   <br/>   logit(<em>p</em><em><sub>i</sub></em>) = a<sub>0</sub> + <em>a</em><sub>1</sub><em>x</em><sub>1</sub><em><sub>i</sub></em> + <em>a</em><sub>2</sub><em>x</em><sub>2</sub><em><sub>i</sub></em> + <em>a</em><sub>12</sub><em>x</em><sub>1</sub><em><sub>i </sub></em><em>x</em><sub>2</sub><em><sub>i</sub></em> + <em>b</em><em><sub>i</sub></em><br/>   <br/>   <em>b</em><em><sub>i</sub></em> ~ Normal(0, <font><em>τ</em></font>)<br/>   <br/>where <em>x</em><sub>1</sub><em><sub>i</sub></em> and <em>x</em><sub>2</sub><em><sub>i</sub></em> are the seed type and root extract of the <em>i </em><sup>th</sup> plate, and an interaction term <em>a</em><sub>12</sub><em>x</em><sub>1</sub><em><sub>i</sub></em><em>x</em><sub>2</sub><em><sub>i</sub></em> is included.<br/><br/><h5 id="SpecifyingAModelInTheBUGSLanguage">Specifying a model in the BUGS language</h5>The BUGS language allows a concise expression of the model, using the 'twiddles' symbol <code>~</code> to denote stochastic (probabilistic) relationships, and the left arrow ('<code>&lt;</code>' sign followed by '<code>-</code>' sign) to denote deterministic (logical) relationships. The stochastic parameters a<sub>0</sub>, a<sub>1</sub>, a<sub>2</sub>, a<sub>12</sub>, and <font>τ</font> are given proper but minimally informative prior distributions, while the logical expression for sigma allows the standard deviation (of the random effects distribution) to be estimate<br/><br/><br/><code>   model <br/>   {<br/>      for (i in 1:N) {<br/>         r[i] ~ dbin(p[i], n[i])<br/>         b[i] ~ dnorm(0, tau)<br/>         logit(p[i]) &lt;- alpha0 + alpha1 * x1[i] + alpha2 * x2[i]<br/>                     + alpha12 * x1[i] * x2[i] + b[i]<br/>      }<br/>      alpha0 ~ dnorm(0, 1.0E-6)<br/>      alpha1 ~ dnorm(0, 1.0E-6)<br/>      alpha2 ~ dnorm(0, 1.0E-6)<br/>      alpha12 ~ dnorm(0, 1.0E-6)<br/>      tau ~ dgamma(0.001, 0.001)<br/>      sigma &lt;- 1 / sqrt(tau)<br/>   }<br/></code><br/>More detailed descriptions of the BUGS language along with lists of the available logical functions and stochastic distributions can be found in <a href="/documentation/latest/ModelSpecification.html"></a><a href="/documentation/latest/ModelSpecification.html">Model Specification</a>, <a href="/documentation/latest/Distributions.html"></a><a href="/documentation/latest/Distributions.html">Distributions</a>, and <a href="/documentation/latest/Functions.html"></a><a href="/documentation/latest/Functions.html">Functions and functionals</a>. See also the included examples: <a href="/examples/latest/VolumeI.html"></a><a href="/examples/latest/VolumeI.html">Volume I</a>, <a href="/examples/latest/VolumeII.html"></a><a href="/examples/latest/VolumeII.html">Volume 2</a>, <a href="/examples/latest/VolumeIII.html"></a><a href="/examples/latest/VolumeIII.html">Volume 3</a> and <a href="/examples/latest/VolumeIV.html"></a><a href="/examples/latest/VolumeIV.html">Volume 4</a>. An alternative way of specifying a model in BUGS is to use the graphical interface known as <a href="/documentation/latest/DoodleBUGS.html">DoodleBUGS</a>.<br/><br/><h5 id="RunningAModelInWinBUGS">Running a model in BUGS</h5>The BUGS software uses <a href="/documentation/latest/CompoundDocuments.html">compound documents</a><a href="/documentation/latest/CompoundDocuments.html"></a>, which comprise various different types of information (formatted text, tables, formulae, plots, graphs, etc.) displayed in a single window and stored in a single file. This means that it is possible to run the model for the "seeds" example directly from this tutorial document, since the model code can be made 'live' just by highlighting it. However, it is more usual when creating your own models to have the model code and data etc. in separate files. We have therefore created a separate file with the model code in it for this tutorial - you will find the file in <a href="/examples/latest/Seedsmodel.html"></a><a href="/examples/latest/Seedsmodel.html">Examples/Seedsmodel</a>.<br/><br/><br/><strong>Step 1:</strong> Open the Seedsmodel file as follows:<br/><br/>* Choose the <span class="button">Open...</span> option from the <span class="button">File</span> menu.<br/>* Select the Examples directory and double-click on the Seeds file to open.<br/><br/><strong>Step 2:</strong> To run the model, we first need to check that the model description does fully define a probability model:<br/><br/>* Choose the <span class="button">Specification</span> option from the <span class="button">Model</span> menu.<br/>* Focus the window containing the model code by clicking once (left mouse button) anywhere in the window - the top panel of the window should then become highlighted in blue (usually) to indicate that the window is currently in focus.<br/>* Highlight the word <code>model</code> at the beginning of the code by double clicking on the word (left mouse button).<br/>* Check the model syntax by clicking once on the <span class="button">check model</span> button in the <span class="window_title">Specification Tool</span> window. A message saying "model is syntactically correct" should appear in the bottom left of the BUGS program window.<br/><br/><br/><strong>Step 3:</strong> We next need to load in the data. The data can be represented using <a href="/documentation/latest/ModelSpecification.html#FormattingOfDataSPlusFormat">S-Plus object notation</a> (file <a href="/examples/latest/Seedsdata.html">Example/Seedsdata</a>), or as a combination of an S-Plus object and a <a href="/documentation/latest/ModelSpecification.html#FormattingOfDataRectangularFormat">rectangular array</a> with labels at the head of each column.<br/><br/>* Open one of the data files now.<br/><br/>* To load the data in file Examples/Seedsdata:<br/>- Highlight the word <code>list</code> at the beginning of the data file.<br/>- Click once on the <span class="button">load data</span> button in the <span class="window_title">Specification Tool</span> window. A message saying "data loaded" should appear in the bottom left of the BUGS program window.<br/><br/><strong>Step 4:</strong> Now we need to select the number of chains (i.e. sets of samples to simulate). The default is 1, but we will use 2 chains for this tutorial, since running multiple chains is one way to <a href="#CheckingConvergence">check the convergence</a> of your MCMC simulations.<br/><br/>* Type the number <code>2</code> in the white box labelled <span class="button">num of chains</span> in the <span class="window_title">Specification Tool</span> window. In practice, if you have a fairly complex model, you may wish to do a pilot run using a single chain to check that the model compiles and runs and obtain an estimate of the time taken per iteration. Once you are happy with the model, re-run it using multiple chains (say 2-5 chains) to obtain a final set of posterior estimates.<br/><br/><strong>Step 5:</strong> Next compile the model by clicking on the <span class="button">compile</span> button in the <span class="window_title">Specification Tool</span> window. A message saying "model compiled" should appear in the bottom left of the BUGS program window. This sets up the internal data structures and chooses the specific <a href="/documentation/latest/Introduction.html#IntroductionMCMCMethods">MCMC updating algorithms</a> to be used by BUGS for your particular model.<br/><br/><strong>Step 6:</strong> Finally the MCMC sampler must be given some initial values for each stochastic node. These can be arbitrary values, although in practice, convergence can be poor if wildly inappropriate values are chosen. You will need a different set of initial values for each chain, i.e. two sets are needed for this tutorial since we have specified two chains - these are stored in files <a href="/examples/latest/Seedsinits.html"></a><a href="/examples/latest/Seedsinits.html">Examples/Seedsinits</a> and <a href="/examples/latest/Seedsinits1.html"></a><a href="/examples/latest/Seedsinits1.html">Examples/Seedsinits1</a>.<br/><br/>* Open thess files now.<br/>* To load the initial values:<br/>- Highlight the word <code>list</code> at the beginning of the set of initial values.<br/>- Click once on the <span class="button">load inits</span> button in the <span class="window_title">Specification Tool</span> window. A message saying "initial values loaded: this or another chain contains uninitialized nodes" should appear in the bottom left of the BUGS program window.- Repeat this process for the second initial values file. A message saying "initial values loaded: model initialized" should now appear in the bottom left of the BUGS program window.<br/><br/>Note that you do not need to provide a list of initial values for every parameter in your model. You can get BUGS to generate initial values for any stochastic parameter not already initialized by clicking on the <span class="button">gen inits</span> button in the <span class="window_title">Specification Tool</span> window. BUGS generates initial values by forward sampling from the prior distribution for each parameter. Therefore, you are advised to <strong>provide your own initial values for parameters with vague prior distributions</strong> to avoid wildly inappropriate values.<br/><br/><strong>Step 7:</strong> Close the <span class="window_title">Specification Tool</span> window. You are now ready to start running the simulation. However, before doing so, you will probably want to set some monitors to store the sampled values for selected parameters. For the seeds example, set monitors for the parameters <code>alpha0</code>, <code>alpha1</code>, <code>alpha2</code>, <code>alpha12</code> and sigma - see <a href="#MonitoringParameterValues">here</a> for details on how to do this.<br/><br/>To run the simulation:<br/><br/>* Select the <span class="button">Update...</span> option from the <span class="button">Model</span> menu.<br/>* Type the number of updates (iterations of the simulation) you require in the appropriate white box (labelled <span class="button">updates</span>) in the <span class="window_title">Update Tool</span> window - the default value is 1000.<br/>* Click once on the <span class="button">update</span> button: the program will now start simulating values for each parameter in the model. This may take a few seconds - the box marked <span class="button">iteration</span> will tell you how many updates have currently been completed. The number of times this value is revised depends on the value you have set for the <span class="button">refresh</span> option in the white box above the <span class="button">iteration</span> box. The default is every 100 iterations, but you can ask the program to report more frequently by changing <span class="button">refresh</span> to, say, 10 or 1. A sensible choice will depend on how quickly the program runs. For the seeds example, experiment with changing the refresh option from 100 to 10 and then 1.<br/>* When the updates are finished, the message "updates took *** s" will appear in the bottom left of the BUGS program window (where *** is the number of seconds taken to complete the simulation).<br/>* If you previously set monitors for any parameters you can now check convergence and view graphical and numerical summaries of the samples. Do this now for the parameters you monitored in the seeds example - see <a href="#CheckingConvergence">Checking convergence</a>for tips on how to do this (for the seeds example, you should find that at least 2000 iterations are required for convergence).<br/>* Once you're happy that your simulation has converged, you will need to run some further updates to obtain a sample from the posterior distribution. The section <a href="#HowManyIterationsAfterConvergence?">How many iterations after convergence?</a><a href="#HowManyIterationsAfterConvergence?"></a> provides tips on deciding how many more updates you should run. For the seeds example, try running a further 10000 updates.<br/>* Once you have run enough updates to obtain an appropriate sample from the posterior distribution, you may summarise these samples numerically and graphically (see section <a href="#ObtainingSummariesOfThePosteriorDistribution">Obtaining summaries of the posterior distribution</a><a href="#ObtainingSummariesOfThePosteriorDistribution"></a> for details on how to do this). For the seeds example, summary statistics for the monitored parameters are shown below:<br/><br/><font color="#000100" face="Courier New" size="2"><strong>      mean   sd   MC_error   val2.5pc   median   val97.5pc   start   sample<br/>   alpha0   -0.5473   0.1935   0.003929   -0.9384   -0.5448   -0.1678   4001   14000<br/>   alpha1   0.06959   0.3203   0.006121   -0.5839   0.08103   0.667   4001   14000<br/>   alpha12   -0.8165   0.4377   0.008459   -1.69   -0.8186   0.05156   4001   14000<br/>   alpha2   1.352   0.2718   0.005731   0.8208   1.349   1.906   4001   14000<br/>   sigma   0.2943   0.1435   0.005438   0.05322   0.2827   0.6112   4001   14000<br/></strong></font><br/>* To save any files created during your BUGS run, focus the window containing the information you want to save, and select the <span class="button">Save As...</span> option from the <span class="button">File</span> menu.<br/>* To quit BUGS, select the <span class="button">Exit</span> option from the <span class="button">File</span> menu.<br/><br/><br/><h5 id="MonitoringParameterValues">Monitoring parameter values</h5>In order to check convergence and obtain posterior summaries of the model parameters, you first need to set <strong>monitors</strong> for each parameter of interest. This tells BUGS to store the values sampled for those parameters; otherwise, BUGS automatically discards the simulated values.<br/><br/>There are two types of monitor in BUGS:<br/><br/><a id="SamplesMonitors"></a><a id="SamplesMonitors">Samples monitors:</a> Setting a samples monitor tells BUGS to store<em> every</em> value it simulates for that parameter. You will need to set a samples monitor if you want to view trace plots of the samples to check convergence (see <a href="#CheckingConvergence">Checking convergence</a><a href="#CheckingConvergence"></a>) or if you want to obtain 'exact' posterior quantiles, for example, the posterior 95% Bayesian credible interval for that parameter. (Note that you can also obtain <em>approximate</em> 2.5%, 50% and 97.5% quantiles of the posterior distribution for each parameter using <a href="#SummaryMonitors">summary monitors</a>.)<br/><br/>To set a samples monitor:<br/><br/>* Select <span class="button">Samples...</span> from the <span class="button">Inference</span> menu;<br/>* Type the name of the parameter to be monitored in the white box marked <span class="button">node</span> in the <span class="window_title">Sample Monitor Tool</span> window <br/>* Click once on the button marked <span class="button">set</span><br/>* Repeat for each parameter to be monitored.<br/><br/><a id="SummaryMonitors"></a><a id="SummaryMonitors">Summary monitors:</a> Setting a summary monitor tells BUGS to store the running mean and standard deviation for the parameter, plus approximate running quantiles (2.5%, 50% and 97.5%). The values saved contain less information than saving each individual sample in the simulation, but require much less storage. This is an important consideration when running long simulations (e.g. 1000's of iterations) and storing values for many variables.<br/><br/>We recommend setting summary monitors on long vectors of parameters such as random effects in order to store posterior summaries, and then also setting full <a href="#SamplesMonitors">samples monitors</a><a href="#SamplesMonitors"></a> on a small subset of the random effects, plus other relevant parameters (e.g. means and variances), to check convergence.<br/><br/>To set a summary monitor:<br/><br/>* Select <span class="button">Summary...</span> from the <span class="button">Inference</span> menu;<br/>* Type the name of the parameter to be monitored in the white box marked <span class="button">node</span> in the <span class="window_title">Summary Monitor Tool</span> window <br/>* Click once on the button marked <span class="button">set</span><br/>* Repeat for each parameter to be monitored.<br/>      <br/><strong>Note: you should not set a summary monitor until you are happy that convergence has been reached (see </strong><a href="#CheckingConvergence">Checking convergence</a><strong>), since it is not possible to discard any of the pre-convergence ('burn-in') values from the summary once it is set, ot</strong><strong>her than to clear the monitor and re-set it.<br/><br/></strong><br/><h5 id="CheckingConvergence">Checking convergence</h5>Checking convergence requires considerable care. <strong>It is very difficult to say conclusively that a chain (simulation) has converged, only to diagnose when it definitely hasn't!</strong><br/><br/>The following are practical guidelines for assessing convergence:<br/><br/>* For models with many parameters, it is impractical to check convergence for every parameter, so just choose a selection of relevant parameters to monitor. For example, rather than checking convergence for every element of a vector of random effects, just choose a random subset (say, the first 5 or 10).<br/>* Examine trace plots of the sample values versus iteration to look for evidence of when the simulation appears to have stabilised:<br/><br/>To obtain 'live' trace plots for a parameter:<br/><br/>- Select <span class="button">Samples...</span> from the <span class="button">Inference </span>menu.<br/>- Type the name of the parameter in the white box marked <span class="button">node </span>in the <span class="window_title">Sample Monitor Tool</span> window <br/>- Click once on the button marked <span class="button">trace</span>: an empty graphics window will appear on screen.<br/>- Repeat for each parameter of interest.<br/>- Once you start running the simulations (using the <span class="button">Update...</span> tool from the <span class="button">Model</span> menu), trace plots for these parameters will appear 'live' in the graphics windows.<br/><br/>To obtain a trace plot showing the full history of the samples <em>for any parameter for which you have previously set a samples monitor and carried out some updates</em>:<br/><br/>- Select <span class="button">Samples...</span> from the <span class="button">Inference </span>menu.<br/>- Type the name of the parameter in the white box marked <span class="button">node</span> (or select the name from the pull down list of currently monitored nodes - click once on the downward-facing arrowhead to the immediate right of the <span class="button">node</span> field) in the <span class="window_title">Sample Monitor Tool</span> window.<br/>- Click once on the button marked <span class="button">history</span>: a graphics window showing the sample trace will appear.<br/>- Repeat for each parameter of interest.<br/><br/>The following plots are examples of: (i) chains for which convergence (in the pragmatic sense) looks reasonable (top two plots); and (ii) chains which have clearly not reached convergence (bottom two plots).<font color="#000100" face="Arial" size="2"><br/><br/><img alt="[tutorial2]" src="tutorial2.bmp"/><br/><img alt="[tutorial3]" src="tutorial3.bmp"/></font><font color="#000100" face="Arial" size="2"><br/><img alt="[tutorial4]" src="tutorial4.bmp"/><img alt="[tutorial5]" src="tutorial5.bmp"/></font><br/>If you are running more than one chain simultaneously, the trace and history plots will show each chain in a different colour. In this case, we can be reasonably confident that convergence has been achieved if all the chains appear to be overlapping one another.<br/><br/>The following plots are examples of: (i) multiple chains for which convergence looks reasonable (top); and (ii) multiple chains which have clearly not reached convergence (bottom).<br/><font color="#000100" face="Arial" size="2"><br/><br/><img alt="[tutorial6]" src="tutorial6.bmp"/></font><font color="#000100" face="Arial" size="2"><br/><img alt="[tutorial7]" src="tutorial7.bmp"/><br/><br/></font>For a more formal approach to convergence diagnosis the software also provides an implementation (see <a href="/documentation/latest/InferenceMenu.html#SamplesDialogBGRDiag">here</a>) of the techniques described in <a href="/documentation/latest/References.html#BGRDiagPaper">Brooks &amp; Gelman (1998)</a><a href="/documentation/latest/References.html#BGRDiagPaper"></a>, and a facility for outputting monitored samples in a format that is compatible with the <a href="/documentation/latest/References.html#CODARef">CODA software</a> - see <a href="/documentation/latest/InferenceMenu.html#SamplesDialogCODA">here</a>.<br/><br/><br/><h5 id="HowManyIterationsAfterConvergence">How many iterations after convergence</h5>Once you are happy that convergence has been achieved, you will need to run the simulation for a further number of iterations to obtain samples that can be used for posterior inference. The more samples you save, the more accurate will be your posterior estimates.<br/><br/>One way to assess the accuracy of the posterior estimates is by calculating the Monte Carlo error for each parameter. This is an estimate of the difference between the mean of the sampled values (which we are using as our estimate of the posterior mean for each parameter) and the true posterior mean.<br/><br/>As a rule of thumb, the simulation should be run until the Monte Carlo error for each parameter of interest is less than about 5% of the sample standard deviation. The Monte Carlo error (MC error) and sample standard deviation (SD) are reported in the summary statistics table (see the next section)<font color="#0000FF" face="Courier New" size="3">.</font><br/><br/><br/><h5 id="ObtainingSummariesOfThePosteriorDistribution">Obtaining summaries of the posterior distribution</h5>The posterior samples may be summarised either graphically, e.g. by kernel density plots, or numerically, by calculating summary statistics such as the mean, variance and quantiles of the sample.<br/><br/>To obtain summaries of the monitored samples, to be used for posterior inference:<br/><br/>* Select <span class="button">Samples...</span> from the <span class="button">Inference </span>menu.<br/>* Type the name of the parameter in the white box marked <span class="button">node</span> (or select the name from the pull down list, or type "<code>*</code>" (star) to select all monitored parameters) in the <span class="window_title">Sample Monitor Tool</span> window .   * Type the iteration number that you want to start your summary from in the white box marked <span class="button">beg</span>: this allows the pre-convergence 'burn-in' samples to be discarded.<br/>* Click once on the button marked <span class="button">stats</span>: a table reporting various summary statistics based on the sampled values of the selected parameter will appear.<br/>* Click once on the button marked <span class="button">density</span>: a window showing kernel density plots based on the sampled values of the selected parameter will appear.<br/><br/>Please see the manual entry <a href="/documentation/latest/InferenceMenu.html#Samples">Samples...</a><a href="/documentation/latest/InferenceMenu.html#Samples"></a> for a detailed description of the <span class="window_title">Sample Monitor Tool</span> window (i.e. that which appears when <span class="button">Samples...</span> is chosen from the <span class="button">Inference</span> menu).<br/>

</p>


</div><div class="d-none d-lg-block col-lg-3 col-xl-3" id="onthispage"><div class="sticky-top stickymenu"><h5>On this page</h5><ul><li><a href="#Introduction">Introduction</a></li><li><a href="#SpecifyingAModelInTheBUGSLanguage">Specifying a model in the BUGS language</a></li><li><a href="#RunningAModelInWinBUGS">Running a model in WinBUGS</a></li><li><a href="#MonitoringParameterValues">Monitoring parameter values</a></li><li><a href="#CheckingConvergence">Checking convergence</a></li><li><a href="#HowManyIterationsAfterConvergence">How many iterations after convergence?</a></li><li><a href="#ObtainingSummariesOfThePosteriorDistribution">Obtaining summaries of the posterior distribution</a></li></ul></div></div></div></div></body></html>