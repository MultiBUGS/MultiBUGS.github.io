<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd">
<html><head>
<title>ModelSpecification</title>

<link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" rel="stylesheet"/>
<script crossorigin="anonymous" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
<link href="/css/bootstrap.css" rel="stylesheet"/>
<link href="images/favicon.ico" rel="icon" type="image/x-icon"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
</head>
<body>
<nav class="navbar navbar-expand sticky-top navbar-light bg-light">
<a class="navbar-brand" href="/"><img src="/images/logo.svg"/>MultiBUGS</a>
<div class="collapse navbar" id="navbarSupportedContent">
<ul class="navbar-nav mr-auto">
<li class="nav-item">
<a class="nav-link" href="/">Home</a>
</li>
<li class="nav-item">
<a class="nav-link" href="/about">About</a>
</li>
<li class="nav-item">
<a class="nav-link" href="/download">Download</a>
</li>
<li class="nav-item active">
<a class="nav-link" href="/documentation/latest/">Documentation <span class="sr-only">(current)</span></a>
</li>
<li class="nav-item">
<a class="nav-link" href="/examples/latest/">Examples</a>
</li>
</ul>
</div>
</nav><div class="container-fluid"><div class="row main"><div class="col-md-3 col-lg-2 col-xl-3"><div class="sticky-top stickymenu" id="contents">
<button aria-controls="navbarContents" aria-expanded="false" aria-label="Toggle docs navigation" class="btn btn-link d-md-none ml-3 mr-3 mt-3 collapsed mb-toggler" data-target="#navbarContents" data-toggle="collapse" type="button">
<span class="mb-toggler-icon mr-1"></span>
    Contents
  </button>

<h5 class="d-none d-md-block">Contents</h5>
<div class="collapse mb-links" id="navbarContents">
<ul class="list-unstyled">
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#basics">Basics</a>
<ul class="collapse" id="basics">
<li><a href="/documentation/latest/Introduction.html">Introduction</a></li>
<li><a href="/documentation/latest/Tutorial.html">Tutorial</a></li>
<li><a href="/documentation/latest/CompoundDocuments.html">Compound documents</a></li>
<li><a href="/documentation/latest/Graphics.html">Graphics</a></li>
<li><a href="/documentation/latest/DoodleBUGS.html">DoodleBUGS</a></li>
<li><a href="/documentation/latest/Scripts.html">Scripts</a></li>
</ul>
</li>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#language">BUGS language</a>
<ul class="collapse show" id="language">
<li>Model specification</li>
<li><a href="/documentation/latest/Distributions.html">Distributions</a></li>
<li><a href="/documentation/latest/Functions.html">Functions and functionals</a></li>
<li><a href="/documentation/latest/Tricks.html">Advanced uses</a></li>
<li><a href="/documentation/latest/TipsTroubleshooting.html">Tips and troubleshooting</a></li>
</ul>
</li>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#menus">Menus</a>
<ul class="collapse" id="menus">
<li><a href="/documentation/latest/FileMenu.html">File</a></li>
<li><a href="/documentation/latest/EditMenu.html">Edit</a></li>
<li><a href="/documentation/latest/AttributesMenu.html">Attributes</a></li>
<li><a href="/documentation/latest/ToolsMenu.html">Tools</a></li>
<li><a href="/documentation/latest/TextMenu.html">Text</a></li>
<li><a href="/documentation/latest/InfoMenu.html">Info</a></li>
<li><a href="/documentation/latest/ModelMenu.html">Model</a></li>
<li><a href="/documentation/latest/InferenceMenu.html">Inference</a></li>
<li><a href="/documentation/latest/DoodleMenu.html">Doodle</a></li>
<li><a href="/documentation/latest/MapMenu.html">Map</a></li>
<li><a href="/documentation/latest/ExamplesMenu.html">Examples</a></li>
<li><a href="/documentation/latest/ManualsMenu.html">Manuals</a></li>
<li><a href="/documentation/latest/HelpMenu.html">Help</a></li>
</ul>
</li>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#geobugs">GeoBUGS</a>
<ul class="collapse" id="geobugs">
<li><a href="/documentation/latest/spatial/Manual.html">Introduction</a></li>
<li><a href="/documentation/latest/spatial/ImportExport.html">Importing/exporting maps</a></li>
<li><a href="/documentation/latest/spatial/AdjacencyMatrices.html">Adjacency matrices</a></li>
<li><a href="/documentation/latest/spatial/Maps.html">Creating maps</a></li>
<li><a href="/documentation/latest/spatial/SpatialDistributions.html">Spatial distributions</a></li>
<li><a href="/documentation/latest/spatial/TemporalDistributions.html">Temporal distributions</a></li>
</ul>
</li>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#reliability">ReliaBUGS</a>
<ul class="collapse" id="reliability">
<li><a href="/documentation/latest/reliability/Contents.html">Introduction</a></li>
<li><a href="/documentation/latest/reliability/Analysis.html">Basics</a></li>
<li><a href="/documentation/latest/reliability/Distributions.html">Distributions</a></li>
<li><a href="/documentation/latest/reliability/Functions.html">Logical functions</a></li>
<li><a href="/documentation/latest/reliability/References.html">References</a></li>
</ul>
</li>
<li class="nav-item"><a aria-expanded="true" class="dropdown-toggle nav-link" data-toggle="collapse" href="#developer">Developer</a>
<ul class="collapse" id="developer">
<li><a href="/documentation/latest/developer/Manual.html">Contents</a></li>
<li><a href="/documentation/latest/developer/Tools.html">Setting up the development tools</a></li>
<li><a href="/documentation/latest/developer/Compiling.html">Compiling the Source Code</a></li>
<li><a href="/documentation/latest/developer/Initializing.html">Initializing OpenBUGS</a></li>
<li><a href="/documentation/latest/developer/WritingBUGSExtensions.html">Writing OpenBUGS extensions</a></li>
<li><a href="/documentation/latest/developer/SamplingAlgorithms.html">Sampling algorithms</a></li>
<li><a href="/documentation/latest/developer/BlueDiamonds.html">Blue diamonds</a></li>
<li><a href="/documentation/latest/developer/SoftDocu.html">Bugs subsystems</a></li>
<li><a href="/documentation/latest/developer/Distributing.html">Distributing OpenBUGS</a></li>
</ul>
</li>
<!--<li><a href="/documentation/latest/References.html">References</a>-->
</ul>
</div>
</div></div><div class="col-12 col-md-9 col-lg-7 col-xl-6">


<p>
<h4>BUGS model specification language</h4><br/><h5 id="GraphicalModels">Graphical models</h5>We strongly recommend that the first step in any analysis should be the construction of a <em>directed graphical model</em>. Briefly, this represents all quantities as nodes in a directed graph, in which arrows run to nodes from their direct influences (parents). The model represents the assumption that, given its parent nodes pa[<em>v</em>], each node <em>v</em> is independent of all other nodes in the graph except descendants of <em>v</em>, where descendant has the obvious definition.<br/><br/>Nodes in the graph are of three types.<br/>1. <em>Constants</em> are fixed by the design of the study: they are always founder nodes (<em>i.e.</em> do not have parents), and are denoted as rectangles in the graph. <br/>2. <em>Stochastic nodes</em> are variables that are given a distribution, and are denoted as ellipses in the graph; they may be parents or children (or both). Stochastic nodes may be observed in which case they are <em>data</em>, or may be unobserved and hence be <em>parameters</em>, which may be unknown quantities underlying a model, observations on an individual case that are unobserved say due to censoring, or simply missing data.<br/>3. <em>Deterministic nodes</em> are logical functions of other nodes.<br/><br/>Quantities are specified to be data by giving them values in a data declaration. Values for constants can also specified as data.<br/><br/>Directed links may be of two types: a thin solid arrow indicates a stochastic dependence while a thick hollow arrow indicates a logical function. An undirected dashed link may also be drawn to represent an upper or lower bound for a stochastic node.<br/><br/>Repeated parts of the graph can be represented using a 'plate', as shown below for the range <code>(i in 1:N)</code>.<br/></p><center><font color="#000100" face="Arial" size="2"><br/><img alt="[modelspecification1]" src="modelspecification1.bmp"/><br/><br/></font><br/>A simple graphical model, where <code>Y[i]</code> depends on <code>mu[i]</code> and <code>tau</code>, with <code>mu[i]</code><br/>being a logical function of <code>alpha</code> and <code>beta</code>.<br/><br/></center><br/>The conditional independence assumptions represented by the graph mean that the full joint distribution of all quantities <em>V</em> has a simple factorisation in terms of the conditional distribution p(<em>v </em>| parents[<em>v</em>]) of each node given its parents, so that <br/><br/>p(V) = <font>Π</font> p(v | parents[va]) v in V<br/><br/>The crucial idea is that we need only provide the parent-child distributions in order to fully specify the model, and <em>BUGS </em>then sorts out the necessary sampling methods directly from the expressed graphical structure.<br/><br/><h5 id="GraphsAsAFormalLanguage">Graphs as a formal language</h5>A special drawing tool <a href="/documentation/latest/DoodleBUGS.html">DoodleBUGS</a><a href="/documentation/latest/DoodleBUGS.html"></a> has been developed for specifying graphical models, which uses a hyper-diagram approach to add extra information to the graph to give a complete model specification. Each stochastic and logical node in the graph must be given a name using the conventions explained in <a href="/documentation/latest/DoodleBUGS.html#CreatingANode">Creating a node</a><a href="/documentation/latest/DoodleBUGS.html#CreatingANode"></a>.<br/><br/><center><font color="#000100" face="Arial" size="2"><br/>.<img alt="[modelspecification2]" src="modelspecification2.bmp"/><br/><br/></font></center>The shaded node <code>Y[i]</code> is normally distributed with mean <code>mu[i]</code> and precision <code>tau</code>.<center><br/><img alt="[modelspecification3]" src="modelspecification3.bmp"/></center>         <br/>The shaded node <code>mu[i]</code> is a logical function of <code>alpha</code>, <code>beta</code>, and the constants <code>x</code>. (<code>x</code> is not required to be shown in the graph).<br/>         <br/>The value function of a logical node contains all the necessary information to define the logical node.<br/>   <br/>As an alternative to the Doodle representation, the model can be specified using the text-based <em>BUGS</em> language, headed by the model statement:<br/><br/><code>model {<br/></code><em>text-based description of graph in BUGS language</em><code><br/>}</code><br/><br/><br/><h5 id="TheBUGSLanguageStochasticNodes">The BUGS language: stochastic nodes</h5>In the text-based model description, stochastic nodes are represented by the node name followed by a tilda symbol followed by the distribution name followed by a comma-separated list of parents enclosed in brackets, <em>e.g.<br/><br/>   </em><code>   x ~ dnorm(mu, tau)</code><br/>            <br/>The distributions that can be used in <em>BUGS </em>are described in <a href="/documentation/latest/Distributions.html"></a><a href="/documentation/latest/Distributions.html">Distributions</a>. The parameters of a distribution must be explicit nodes in the graph (scalar parameters can also be numerical constants) and so may not be expressions.<br/><br/><a id="ConstraintsOnUsingCertainDistributions">Multivariate</a> nodes must form contiguous elements in an array. Since the final element in an array changes fastest, such nodes must be defined as the final part of any array. For example, to define a set containing <code>I</code> multivariate normal variables of dimensional <code>K</code> as a single multidimensional array <code>x[i, j]</code>, we could write: <br/><br/><code>for (i in 1:I) {<br/>x[i,1:K] ~ dmnorm(mu[], tau[,])<br/>}</code><br/><br/>Data defined by a multivariate distribution must not contain missing (unobserved) values. The only exception to this rule is the multivariate normal distribution. We realise this is an unfortunate restriction and we hope to relax it in the future. For multinomial data, it may be possible to get round this problem by re-expressing the multivariate likelihood as a sequence of conditional univariate binomial distributions or as Poisson distributions. <br/>Censoring is denoted using the notation <code>C(lower, upper)</code> <em>e.g.</em><br/><br/><code>x ~ dnorm(mu, tau)C(lower, upper)</code><br/><br/>would denote a quantity <code>x</code> from the normal distribution with parameters <code>mu</code>, <code>tau</code>, which had been observed to lie between <code>lower</code> and <code>upper</code>. Leaving either lower or upper blank corresponds to no limit, e.g. <code>C(lower,)</code> corresponds to an observation known to lie above lower. Whenever censoring is specified the censored node contributes a term to the full conditional distribution of its parents. This structure is only of use if <code>x</code> has not been observed (if <code>x</code> is observed then the constraints will be ignored). In general multivariate nodes can not be censored, the multivariate normal distribution is exempted from this restriction.<br/>Truncation is denoted by using the notation <code>T(lower, upper)</code> <em>e.g.</em><br/><br/><code>x ~ dnorm(mu, tau)T(lower, upper)</code><br/><br/>would denote a quantity <code>x</code> from the modified normal distribution normalized by dividing by the integral of the distribution between limits <code>lower</code> and <code>upper</code>, which lies between lower and upper. Leaving either <code>lower</code> or <code>upper</code> blank corresponds to no limit, e.g. <code>T(lower,)</code> corresponds to an observation known to lie above lower. <code>x</code> can either be observed or unobserved.<br/><br/>It is also important to note that if <code>x</code>, <code>mu</code>, <code>tau</code> , <code>lower</code> and <code>upper</code> are all unobserved, then <code>lower</code> and <code>upper</code> must not be functions of <code>mu</code> and <code>tau</code>.<br/><br/>Nodes with a discrete distribution must in general have integer values. Observed variables having a binomial or Poisson distribution are exempt from this restriction.<br/><br/>Certain parameters of distributions must be constants, that is they can not be learnt. These include both parameters of the Wishart distributions, the order (N) of the multinomial distribution and the threshold (mu) of the generalized Pareto distribution.<br/>The precision matrices for multivariate normals must be positive definite. If a Wishart prior is not used for the precision matrix, then the elements of the precision matrix are updated univariately without any check of positive-definiteness. This will result in a crash unless the precision matrix is parameterised appropriately. <strong>This is the user's responsibility! </strong>Forming the precision matrix from the product of cholesky factors will ensure positive definiteness.<br/><br/><h5 id="LogicalNodes">The BUGS language: logical nodes</h5>Logical nodes are represented by the node name followed by a left pointing arrow followed by a logical <a id="expression"></a><a id="expression">expression</a> of its parent nodes e.g.<br/><br/><code>      mu[i] &lt;- beta0 + beta1 * z1[i] + beta2 * z2[i] + b[i]</code><br/>            <br/>Logical expressions can be built using the following operators: plus (<code>A + B</code>), multiplication (<code>A * B</code>), minus (<code>A - B</code>), division (<code>A / B</code>) and unitary minus (<code>-A</code>). The scalar valued functions in <a href="/documentation/latest/Functions.html">Functions and Functionals</a> can also be used in logical expressions. A vector-valued logical function can only be used as the sole term on the right hand side of a vector-valued logical relation.<br/><br/>A link function can also be specified acting on the left hand side of a logical node <em>e.g.</em><br/><br/><code>   logit(mu[i]) &lt;- beta0 + beta1 * z1[i] + beta2 * z2[i] + b[i]</code><br/><br/>The following functions can be used on the left hand side of logical nodes as link functions: <code>log</code>, <code>logit</code>, <code>cloglog</code>, and <code>probit</code> (where <code>probit(x) &lt;- y</code> is equivalent to <code>x &lt;- phi(y)</code>).<br/><br/>A special logical node called "deviance" is created automatically by <em>BUGS</em>: It calculates -2 * log(likelihood), where 'likelihood' is the conditional probability of all data nodes given their stochastic parent nodes. This node can be monitored, and is used in the DIC tool - see <a href="/documentation/latest/InferenceMenu.html#DIC">DIC...</a><br/><br/><br/><h5 id="ArraysAndIndexing">Arrays and indexing</h5><br/>Arrays are indexed by terms within square brackets. The four basic operators <code>+</code>, <code>-</code>, <code>*</code>, and <code>/</code> along with appropriate bracketing are allowed to calculate an integer function as an index, for example:<br/><br/><code>      Y[(i + j) * k, l]</code><br/><br/>On the left-hand-side of a relation, an expression that always evaluates to a fixed value is allowed for an index, whether it is a constant or a function of data. On the right-hand-side the index can be a fixed value or a named node, which allows a straightforward formulation for mixture models in which the appropriate element of an array is 'picked' according to a random quantity (see <a href="#NestedIndexingAndMixtures">Nested indexing and mixtures</a>). However, functions of unobserved nodes are not permitted to appear directly as an index term (intermediate deterministic nodes may be introduced if such functions are required).<br/><br/>The conventions broadly follow those of S-Plus:<br/><br/>   <code>n : m</code>   represents <em>n</em>, <em>n</em> + 1, ..., <em>m</em>.<br/>   <code>x[ ]</code>   represents all values of a vector <em>x</em>.<br/>   <code>y[, 3]</code>   indicates all values of the third column of a two-dimensional array <em>y</em>.<br/>Multidimensional arrays are handled as one-dimensional arrays with a constructed index. Thus functions defined on arrays must be over equally spaced nodes within an array: for example <code>sum(y[i, 1:4, k]).<br/></code><br/>When dealing with unbalanced or hierarchical data a number of different approaches are possible - see <a href="/documentation/latest/Tricks.html#HandlingUnbalancedDatasets">Handling unbalanced datasets</a>. The ideas discussed in <a href="#NestedIndexingAndMixtures">Nested indexing and mixtures</a> may also be helpful in this respect.<br/><br/><br/><h5 id="RepeatedStructures">Repeated structures</h5><br/>Repeated structures are specified using a "for - loop". The syntax for this is:<br/><br/><code>      for (i in a : b) {</code><br/>   <em>         list of statements to be repeated for increasing values of loop-variable </em>i<br/><code>      }</code><br/>         <br/>Note that neither <code>a</code> nor <code>b</code> may be stochastic - see <a href="/documentation/latest/Tricks.html#WhereTheSizeOfASetIsARandomQuantity">here</a> for a possible way to get round this.<br/><br/><h5 id="DataTransformations">Data transformations</h5>Although transformations of data can always be carried out before using <em>BUGS</em>, it is convenient to be able to try various transformations of dependent variables within a model description. For example, we may wish to try both <code><em>y</em></code> and <code><em>sqrt(y)</em></code> as dependent variables without creating a separate variable <code><em>z = sqrt(y)</em></code> in the data file.<br/><br/>The BUGS language therefore permits the following type of structure to occur:<br/><br/><code>for (i in 1:N) {<br/>z[i] &lt;- sqrt(y[i])<br/>z[i] ~ dnorm(mu, tau)<br/>}</code><br/><br/>Strictly speaking, this goes against the declarative structure of the model specification, with the accompanying exhortation to construct a directed graph and then to make sure that each node appears once and only once on the left-hand side of a statement. However, a check has been built in so that, when finding a logical node which also features as a stochastic node (such as z above), a stochastic node is created with the calculated values as fixed data.<br/><br/>We emphasise that this construction is only possible when transforming observed data (not a function of data and parameters) with no missing values.<br/><br/>This construction is particularly useful in Cox modelling and other circumstances where fairly complex functions of data need to be used. It is preferable for clarity to place the transformation statements in a section at the beginning of the model specification, so that the essential model description can be examined separately. See the <a href="/examples/latest/Leuk.html">Leuk</a> and <a href="/examples/latest/Endo.html">Endo</a> examples.<br/><br/><h5 id="NestedIndexingAndMixtures">Nested indexing and mixtures</h5>Nested indexing can be very effective. For example, suppose <code>N</code> individuals can each be in one of <code>I</code> groups, and <code>g[1:N]</code>is a vector which contains the group membership. Then "group" coefficients <code>beta[i]</code> can be fitted using <code>beta[g[j]]</code> in a regression equation.<br/><br/>In the <em>BUGS</em> language, nested indexing can be used for the parameters of distributions: for example, the <a href="/examples/latest/Eyes.html">Eyes</a> example concerns a normal mixture in which the <em>i </em><sup>th</sup> case is in an unknown group <em>T</em><em><sub>i</sub></em> which determines the mean <em>l</em><em><sub>T</sub></em><em><sub>i</sub></em> of the measurement <em>y</em><em><sub>i</sub></em>. Hence the model is<br/><br/>   <em>      T</em><em><sub>i</sub></em> ~ Categorical(<em>P</em>)<br/>   <em>      y</em><em><sub>i</sub></em> ~ Normal(<font><em>λ</em></font><em><sub>T</sub></em><em><sub>i</sub></em> , <font><em>τ</em></font> )<br/><br/>which may be written in the BUGS language <br/><br/><code>for (i in 1:N) {<br/>T[i] ~ dcat(P[])<br/>y[i] ~ dnorm(lambda[T[i]], tau)<br/>}</code><br/><br/>The mixture construct can also be applied to vector value parameters e.g.<br/><br/><code>for (i in 1:ns) {<br/>nbiops[i] &lt;- sum(biopsies[i, ])<br/>true[i] ~ dcat(p[])<br/>biopsies[i, 1:4] ~ dmulti(error[true[i], ], nbiops[i])<br/>}</code><br/><br/>Multiple (up to four) variable indices are allowed in setting up mixture models. e.g.<br/><br/><code>dyspnoea ~ dcat(p.dyspnoea[either, bronchitis, 1:2])<br/>either &lt;- max(tuberculosis, lung.cancer)<br/>bronchitis ~ dcat(p.bronchitis[smoking, 1:2])<br/><br/></code><br/><h5 id="FormattingOfData">Formatting of data</h5>Data can be in an R/S-Plus format (used by R and S-Plus and most of the examples in BUGS) or, for data in arrays, in rectangular format.<br/><br/>Missing values are represented as <code>NA</code>.<br/><br/>Non-integer numbers can be specified as floating point numbers in scientific notation, with the "times ten raised to the power of" denoted by either "<code>E</code>" or "<code>e</code>" (since MultiBUGS 2.0). For example, 0.02 could be represented <code>2E-2</code> or <code>2e-2</code>.<br/><br/>The whole array must be specified in the file - it is not possible just to specify selected components. Any parts of the array you do not want to specify must be filled with <code>NA</code>s.<br/><br/>All variables in a data file must be defined in a model, even if just left unattached to the rest of the model. <br/><br/><strong>R/<a id="FormattingOfDataSPlusFormat">S-Plus format:</a></strong> This allows scalars and arrays to be named and given values in a single structure headed by key-word list. There must be no space after list.<br/><br/>For example, in the Rats example, we need to specify a scalar <code>xbar</code>, dimensions <code>N</code> and <code>T</code>, a vector <code>x</code> and a two-dimensional array <code>Y</code> with 30 rows and 5 columns. This is achieved using the following format:<br/><br/><code>list(<br/>xbar=22, N=30, T=5,<br/>x=c(8.0, 15.0, 22.0, 29.0, 36.0),<br/>Y=structure(<br/>.Data=c(<br/>151, 199, 246, 283, 320,<br/>         145, 199, 249, 293, 354,<br/>         ...<br/>         ...<br/>         137, 180, 219, 258, 291,<br/>         153, 200, 244, 286, 324),<br/>      .Dim=c(30,5)<br/>   )<br/>)<br/></code><br/><em>BUGS</em> reads data into an array by filling the right-most index first, whereas the R/S-Plus program fills the left-most index first. Hence <em>BUGS</em> reads the string of numbers <code>c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)</code> into a 2 * 5 dimensional matrix in the order<br/><br/><code>      [i, j]th element of matrix      value<br/>      [1, 1]                                    1<br/>      [1, 2]                                    2<br/>      [1, 3]                                    3<br/>      ...                                       ...<br/>      [1, 5]                                    5<br/>      [2, 1]                                    6<br/>      ...                                       ...<br/>      [2, 5]                                    10</code><br/><br/>whereas R/S-Plus read the same string of numbers in the o<br/><br/><code>      [i, j]th element of matrix      value<br/>      [1, 1]                                    1<br/>      [2, 1]                                    2<br/>      [1, 2]                                    3<br/>      ...                                       ...<br/>      [1, 3]                                    5<br/>      [2, 3]                                    6<br/>      ...                                       ...<br/>      [2, 5]                                    10</code><br/><br/><br/>Hence the ordering of the array dimensions must be reversed before using the R/S-Plus <code>dput</code> function to create a data file for input into <em>BUGS</em>.<br/><br/>For example, consider the 2 * 5 dimensional matrix<br/><br/><code>      1   2   3   4   5<br/>      6   7   8   9   10<br/></code><br/>This must be stored in R/S-Plus as a 5 * 2 dimensional matrix<br/><br/><code>      &gt; M<br/>      [,1] [,2]<br/>      [1,] 1 6<br/>      [2,] 2 7<br/>      [3,] 3 8<br/>      [4,] 4 9<br/>      [5,] 5 10</code><br/><br/>The R/S-Plus command<br/><br/><code>      &gt; dput(list(M=M), file="matrix.dat")</code><br/><br/>will then produce the following data file<br/><br/><code>      list(M=structure(.Data=c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10),<br/>                              .Dim=c(5,2))</code><br/><br/>Edit the <code>.Dim</code> statement in this file from <code>.Dim=c(5,2)</code> to <code>.Dim=c(2,5)</code>. The file is now in the correct format to input the required 2 * 5 dimensional matrix into <em>BUGS</em>.<br/><br/>Now consider a 3 * 2 * 4 dimensional array<br/><br/><code>      1   2   3   4<br/>      5   6   7   8<br/><br/>      9   10   11   12<br/>      13   14   15   16<br/><br/>      17   18   19   20<br/>      21   22   23   24</code><br/><br/>This must be stored in R/S-Plus as the 4 * 2 * 3 dimensional array:<br/><code><br/>      &gt; A<br/>      , , 1<br/>      [,1] [,2]<br/>      [1,] 1 5<br/>      [2,] 2 6<br/>      [3,] 3 7<br/>      [4,] 4 8<br/><br/>      , , 2<br/>      [,1] [,2]<br/>      [1,] 9 13<br/>      [2,] 10 14<br/>      [3,] 11 15<br/>      [4,] 12 16<br/><br/>      , , 3<br/>      [,1] [,2]<br/>      [1,] 17 21<br/>      [2,] 18 22<br/>      [3,] 19 23<br/>      [4,] 20 24</code><br/><br/>The command<br/><br/><code>      &gt; dput(list(A=A), file="array.dat")</code><br/><br/>will then produce the following data file<br/><br/><code>      list(A=structure(.Data=c( 1, 2, 3, 4, 5, 6, 7, 8,<br/>                                          9, 10, 11, 12, 13, 14, 15, 16,<br/>                                          17, 18, 19, 20, 21, 22, 23, 24),<br/>                              .Dim=c(4,2,3))</code><br/><br/>Edit the <code>.Dim</code> statement in this file from <code>.Dim=c(4,2,3)</code> to <code>.Dim=c(3,2,4)</code>. The file is now in the correct format to input the required 3 * 2 * 4 dimensional array into <em>BUGS </em>in the order<br/><br/><code>      [i, j, k]th element of matrix      value<br/>      [1, 1, 1]                                    1<br/>      [1, 1, 2]                                    2<br/>      ...                                             ...<br/>      [1, 1, 4]                                    4<br/>      [1, 2, 1]                                    5<br/>      [1, 2, 2]                                    6<br/>      ...                                             ...<br/>      [2, 1, 3]                                    11<br/>      [2, 1, 4]                                    12<br/>      [2, 2, 1]                                    13<br/>      [2, 2, 2]                                    14<br/>      ...<br/>      [3, 2, 3]                                    23<br/>      [3, 2, 4]                                    24</code><br/><br/><strong><a id="FormattingOfDataRectangularFormat">Rectangular format:</a> </strong>The columns for data in rectangular format need to be headed by the array name. The arrays need to be of equal size, and the array names must have explicit brackets: for example:<br/><br/><code>      age[]   sex[]<br/>      26   0<br/>      52   1<br/>      ...<br/>      34   0<br/>      END</code><br/><br/><a id="FormattingOfDataENDCommand"></a><a id="FormattingOfDataENDCommand">Note that the file must end with an 'END' keyword, as shown above and below, and this must be followed by at least one blank line.</a><br/><br/>Multi-dimensional arrays can be specified by explicit indexing: for example, the <a href="/examples/latest/Ratsy.html">Ratsy</a> file begins<br/><br/><code>      Y[,1]   Y[,2]   Y[,3]   Y[,4]   Y[,5]<br/>      151   199   246   283   320<br/>      145   199   249   293   354<br/>      147   214   263   312   328<br/>      ...<br/>      153   200   244   286   324<br/>      END</code><br/><br/>The first index position for any array must always be empty.<br/><br/>It is possible to load a mixture of rectangular and R/S-Plus format data files for the same model. For example, if data arrays are provided in a rectangular file, constants can be defined in a separate list statement (see also the <a href="/examples/latest/Rats.html">Rats</a> example with data files <a href="/examples/latest/Ratsx.html">Ratsx</a><a href="/examples/latest/Ratsx.html"></a> and <a href="/examples/latest/Ratsy.html">Ratsy</a><a href="/examples/latest/Ratsy.html"></a>).<br/><br/>(See <a href="/documentation/latest/Tricks.html#HandlingUnbalancedDatasets">here</a><a href="/documentation/latest/Tricks.html#HandlingUnbalancedDatasets"></a> for details of how to handle unbalanced data.)<br/><br/>Note that programs exist for conversion of data from other packages: please see the BUGS resources at http://www.openbugs.info<br/>

<p></p>


</div><div class="d-none d-lg-block col-lg-3 col-xl-3" id="onthispage"><div class="sticky-top stickymenu"><h5>On this page</h5><ul><li><a href="#GraphicalModels">Graphical models</a></li><li><a href="#GraphsAsAFormalLanguage">Graphs as a formal language</a></li><li><a href="#TheBUGSLanguageStochasticNodes">Stochastic nodes</a></li><li><a href="#LogicalNodes">Logical nodes</a></li><li><a href="#ArraysAndIndexing">Arrays and indexing</a></li><li><a href="#RepeatedStructures">Repeated structures</a></li><li><a href="#DataTransformations">Data transformations</a></li><li><a href="#NestedIndexingAndMixtures">Nested indexing and mixtures</a></li><li><a href="#FormattingOfData">Formatting of data</a></li></ul></div></div></div></div></body></html>